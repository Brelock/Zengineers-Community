let status="JS - OK!";function cl(e,t,n,o){return console.log(e,t||"",n||"",o||""),"-"}var glob={navMenuWrapper:null,navMenu:null,pageOverlay:null,scrollTopButton:null},globFunc={returnDOM:function(e){return e instanceof jQuery?e[0]:e},showOverlay:function(e,t,n){switch(e){case"popup":t.classList.contains("js_openPopup")||(t.style.zIndex=1150,t.style.visibility="visible",t.classList.add("js_openPopup"),t.classList.add("js_open"),n&&t.classList.add(n),document.body.classList.add("js_pageOverlayOpen"));break;case"menu":t.classList.contains("js_openMenu")||(t.style.zIndex=900,t.style.visibility="visible",t.classList.add("js_openMenu"),t.classList.add("js_open"),document.body.classList.add("js_pageOverlayOpen"))}},hideOverlay:function(e,t,n){switch(e){case"popup":t.classList.contains("js_openPopup")&&(t.classList.remove("js_openPopup"),t.classList.remove("js_open"),n&&t.classList.remove(n),document.body.classList.remove("js_pageOverlayOpen"),setTimeout(function(){t.classList.contains("js_openPopup")||(t.style.zIndex=-10,t.style.visibility="hidden")},300));break;case"menu":t.classList.contains("js_openMenu")&&(t.classList.remove("js_openMenu"),t.classList.remove("js_open"),document.body.classList.remove("js_pageOverlayOpen"),setTimeout(function(){t.classList.contains("js_openMenu")||(t.style.zIndex=-10,t.style.visibility="hidden")},300))}},toggleButtonContent:function(e,t){var n,o=this.returnDOM(e);t?n=t:e.dataset.text&&(n={default:e.dataset.text,active:e.dataset.textActive}),o.classList.contains("active")?(n&&(o.querySelector("span").innerHTML=n.default),o.classList.remove("active")):(n&&(o.querySelector("span").innerHTML=n.active),o.classList.add("active"))},dropDown:(e,t)=>{e.checked||e.classList.contains("active")?t.style.height=t.firstElementChild.offsetHeight+"px":t.style.height="0px"},animateBlock:function(e){let t=this;this.removeClassFrom(e,"js_animate"),setTimeout(function(){t.addClassTo(e,"js_animate")},50)},getCurrentYPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},addClassTo:function(e,t){var n=this.returnDOM(e);n.classList.contains(t)||n.classList.add(t)},removeClassFrom:function(e,t){var n=this.returnDOM(e);n.classList.contains(t)&&n.classList.remove(t)},transitionHandler:function(e,t,n){e.propertyName&&console.log(e.propertyName),e.srcElement&&console.log(e.srcElement)},getChildsTotalWidth:function(e){let t=e.children,n=0;for(let e=0;e<t.length;e++)n+=t[e].offsetWidth;return n},getCoordsOnPage:function(e){var t=this.returnDOM(e).getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset,bottom:t.bottom+pageYOffset}},getCoordsOnScreen:function(e){var t=this.returnDOM(e).getBoundingClientRect();return{top:t.top,left:t.left,bottom:t.bottom,right:t.right,width:t.width,height:t.height}},openWidth:function(e){e.style.width=getChildsTotalWidth(e)+"px"},collapseWidth:function(e){e.style.width="0"},isVisible:function(e,t){let n;n=t||"whole";var o=window.pageYOffset,s=document.documentElement.clientHeight,i=e.getBoundingClientRect().top+pageYOffset,l=i+e.offsetHeight;return"whole"==n?document.documentElement.clientWidth>991?l<=o+s&&i>=o:i<=o+s/2&&i>=o:"topBorder"==n?i>=o+130&&i<=o+s:"topBorderIn"==n?i<=o+s:void 0},isVisibleOnXAxis:function(e,t){let n=e.getBoundingClientRect().left>t.getBoundingClientRect().left,o=e.getBoundingClientRect().right<t.getBoundingClientRect().right;return n&&o},isLastChild:function(e){return!e.nextElementSibling},isFirstChild:function(e){return!e.previousElementSibling}},test="include js error";$(document).ready(function(){console.log("document ready"),test="include js - OK",glob.navMenuWrapper=document.getElementById("navMenuWrapper"),glob.navMenu=document.getElementById("navMenu"),glob.pageOverlay=document.getElementById("pageOverlay"),$("body")||console.log("jQuery Error"),$(".dropdownButton").on("click",function(){globFunc.toggleButtonContent(this),globFunc.dropDown(this,glob.navMenuWrapper)}),$("body").on("click",".searchButton",function(){let e=$("#popupSearch");e.length&&glob.PopupModule.openPopup(e,"js_openPopup_search")}),$("body").on("click",".button",function(){let e=document.getElementById("id");e&&glob.PopupModule.openPopup(e)}),$(".description .ellipsis").dotdotdot({height:80,truncate:"word",watch:!0}),$(".title.ellipsis").dotdotdot({height:85,truncate:"word",watch:!0});var e=document.querySelectorAll(".description > p");if(e.length)for(var t=0;t<e.length;t++)!e[t].innerHTML&&e[t].parentElement.removeChild(e[t])}),window.onload=function(){console.log("window load")};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInN0YXR1cyIsImNsIiwiYXJnMSIsImFyZzIiLCJhcmczIiwiYXJnNCIsImNvbnNvbGUiLCJsb2ciLCJnbG9iIiwibmF2TWVudVdyYXBwZXIiLCJuYXZNZW51IiwicGFnZU92ZXJsYXkiLCJzY3JvbGxUb3BCdXR0b24iLCJyZXR1cm5ET00iLCJlbGVtZW50IiwialF1ZXJ5Iiwic2hvd092ZXJsYXkiLCJvdmVybGF5VHlwZSIsIm92ZXJsYXlFbGVtZW50IiwiYWRkaXRpb25hbENsYXNzIiwiekluZGV4IiwiY29udGFpbnMiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJjbGFzc0xpc3QiLCJhZGQiLCJkb2N1bWVudCIsImJvZHkiLCJoaWRlT3ZlcmxheSIsInJlbW92ZSIsInNldFRpbWVvdXQiLCJ0b2dnbGVCdXR0b25Db250ZW50IiwiYnV0dG9uRWxlbWVudCIsInN0ck9iaiIsInRleHQiLCJ0aGlzIiwiZGF0YXNldCIsImRlZmF1bHQiLCJidXR0b24iLCJidXR0b25BY3RpdmUiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwiYWN0aXZlIiwiZHJvcERvd24iLCJ0YXJnZXRCbG9jayIsImNoZWNrZWQiLCJoZWlnaHQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsIm9mZnNldEhlaWdodCIsImFuaW1hdGVCbG9jayIsInJlbW92ZUNsYXNzRnJvbSIsImJsb2NrIiwic2VsZiIsImFkZENsYXNzVG8iLCJnZXRDdXJyZW50WVBvc2l0aW9uIiwid2luZG93IiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxUb3AiLCJhY3RpdmVDbGFzcyIsImVsZW0iLCJ0cmFuc2l0aW9uSGFuZGxlciIsImV2ZW50IiwiaGlkZGVuQ29udGVudCIsInByb3BlcnR5TmFtZSIsInNyY0VsZW1lbnQiLCJnZXRDaGlsZHNUb3RhbFdpZHRoIiwicGFyZW50IiwiY2hpbGRyZW4iLCJyZXN1bHQiLCJpIiwibGVuZ3RoIiwib2Zmc2V0V2lkdGgiLCJnZXRDb29yZHNPblBhZ2UiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJsZWZ0IiwicGFnZVhPZmZzZXQiLCJib3R0b20iLCJnZXRDb29yZHNPblNjcmVlbiIsInJpZ2h0Iiwid2lkdGgiLCJvcGVuV2lkdGgiLCJjb2xsYXBzZVdpZHRoIiwiaXNWaXNpYmxlIiwib3B0aW9uIiwib3B0Iiwid2luZG93VG9wIiwid2luZG93SGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiZWxlbVBhZ2VUb3AiLCJlbGVtUGFnZUJvdHRvbSIsImNsaWVudFdpZHRoIiwiaXNWaXNpYmxlT25YQXhpcyIsImlzVmlzaWJsZU9uTGVmdCIsImlzVmlzaWJsZU9uUmlnaHQiLCJpc0xhc3RDaGlsZCIsIm5leHRFbGVtZW50U2libGluZyIsImlzRmlyc3RDaGlsZCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJ0ZXN0IiwicmVhZHkiLCJnZXRFbGVtZW50QnlJZCIsIiQiLCJvbiIsImdsb2JGdW5jIiwibW9kYWwiLCJQb3B1cE1vZHVsZSIsIm9wZW5Qb3B1cCIsImRvdGRvdGRvdCIsInRydW5jYXRlIiwid2F0Y2giLCJ0ZXh0QmxvY2tzIiwicXVlcnlTZWxlY3RvckFsbCIsInBhcmVudEVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsIm9ubG9hZCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsT0FBUyxXQUNiLFNBQVNDLEdBQUdDLEVBQU1DLEVBQU1DLEVBQU1DLEdBRTdCLE9BREFDLFFBQVFDLElBQUlMLEVBQU1DLEdBQVEsR0FBSUMsR0FBUSxHQUFJQyxHQUFRLElBQzNDLElBTVIsSUFBSUcsTUFDSEMsZUFBZ0IsS0FDaEJDLFFBQVMsS0FDVEMsWUFBYSxLQUViQyxnQkFBaUIsTUFLaEJDLFVBQ0VBLFVBQU9DLFNBQUFBLEdBRkksT0FBQUEsYUFBQUMsT0FBQUQsRUFBQSxHQUFBQSxHQU1YRSxZQUFRQyxTQUFSQSxFQUFBQyxFQUFBQyxHQUNFLE9BQUtGLEdBQ0gsSUFBS0MsUUFDSEEsRUFBcUJFLFVBQVND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QUFJRCxFQUFXMUMsT0FDZCxJQUFLLElBQUlELEVBQUksRUFBR0EsRUFBSTJDLEVBQVcxQyxPQUFRRCxLQUN0QzJDLEVBQVczQyxHQUFHN0IsV0FBbUJ3RSxFQUFXM0MsR0FBRzZDLGNBQWNDLFlBQVlILEVBQVczQyxNQTBCdkZmLE9BQU84RCxPQUFTLFdBQ2YvRyxRQUFRQyxJQUFJIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBzdGF0dXMgPSBcIkpTIC0gT0shXCI7XG5mdW5jdGlvbiBjbChhcmcxLCBhcmcyLCBhcmczLCBhcmc0KSB7XG5cdGNvbnNvbGUubG9nKGFyZzEsIGFyZzIgfHwgJycsIGFyZzMgfHwgJycsIGFyZzQgfHwgJycpO1xuXHRyZXR1cm4gJy0nO1xufVxuXG4vLyBjbChzdGF0dXMpO1xuXG5cbnZhciBnbG9iID0ge1xuXHRuYXZNZW51V3JhcHBlcjogbnVsbCxcblx0bmF2TWVudTogbnVsbCxcblx0cGFnZU92ZXJsYXk6IG51bGwsXG5cblx0c2Nyb2xsVG9wQnV0dG9uOiBudWxsLFxufVxuXG4vLyA9PT09PT09PT09PT09PT09PVxudmFyIGdsb2JGdW5jID0ge1xuICByZXR1cm5ET006IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudCBpbnN0YW5jZW9mIGpRdWVyeSA/IGVsZW1lbnRbMF0gOiBlbGVtZW50O1xuICB9LFxuXG4gIHNob3dPdmVybGF5OiBmdW5jdGlvbihvdmVybGF5VHlwZSwgb3ZlcmxheUVsZW1lbnQsIGFkZGl0aW9uYWxDbGFzcykge1xuICAgIHN3aXRjaCAob3ZlcmxheVR5cGUpIHtcbiAgICAgIGNhc2UgXCJwb3B1cFwiOlxuICAgICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlblBvcHVwJykpIHtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS56SW5kZXggPSAxMTUwO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlblBvcHVwJyk7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlbicpO1xuICAgICAgICAgIFxuICAgICAgICAgIGFkZGl0aW9uYWxDbGFzcyA/IG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoYWRkaXRpb25hbENsYXNzKSA6IG51bGw7XG5cbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJqc19wYWdlT3ZlcmxheU9wZW5cIik7XG4gICAgICAgIH0gXG4gICAgICBicmVhaztcblxuICAgICAgY2FzZSBcIm1lbnVcIjpcbiAgICAgICAgaWYgKCFvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5NZW51JykpIHtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS56SW5kZXggPSA5MDA7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuTWVudScpO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX29wZW4nKTtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJqc19wYWdlT3ZlcmxheU9wZW5cIik7XG4gICAgICAgIH0gXG4gICAgICBicmVhaztcbiAgICB9XG4gIH0sXG4gIGhpZGVPdmVybGF5OiBmdW5jdGlvbihvdmVybGF5VHlwZSwgb3ZlcmxheUVsZW1lbnQsIGFkZGl0aW9uYWxDbGFzcykge1xuICAgIHN3aXRjaCAob3ZlcmxheVR5cGUpIHtcbiAgICAgIGNhc2UgXCJwb3B1cFwiOlxuICAgICAgICBpZiAob3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuUG9wdXAnKSkge1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW5Qb3B1cCcpO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcblxuICAgICAgICAgIGFkZGl0aW9uYWxDbGFzcyA/IG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoYWRkaXRpb25hbENsYXNzKSA6IG51bGw7XG5cbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJqc19wYWdlT3ZlcmxheU9wZW5cIik7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlblBvcHVwJykpIHtcbiAgICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gLTEwO1xuICAgICAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMzAwKVxuICAgICAgICB9XG4gICAgICBicmVhaztcblxuICAgICAgY2FzZSBcIm1lbnVcIjpcbiAgICAgICAgaWYgKG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW5NZW51Jyk7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3BlbicpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuTWVudScpKSB7XG4gICAgICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IC0xMDtcbiAgICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIDMwMClcbiAgICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfVxuICB9LFxuXG4gIHRvZ2dsZUJ1dHRvbkNvbnRlbnQ6IGZ1bmN0aW9uIChidXR0b25FbGVtZW50LCBzdHJPYmopIHtcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5yZXR1cm5ET00oYnV0dG9uRWxlbWVudCk7XG4gICAgdmFyIHRleHQ7XG5cbiAgICAvLyBjb25zb2xlLmxvZyhidXR0b25FbGVtZW50KVxuXG4gICAgaWYgKHN0ck9iaikgeyB0ZXh0ID0gc3RyT2JqIH0gZWxzZSBpZiAoYnV0dG9uRWxlbWVudC5kYXRhc2V0LnRleHQpIHtcbiAgICAgIHRleHQgPSB7XG4gICAgICAgIGRlZmF1bHQ6IGJ1dHRvbkVsZW1lbnQuZGF0YXNldC50ZXh0LFxuICAgICAgICBhY3RpdmU6IGJ1dHRvbkVsZW1lbnQuZGF0YXNldC50ZXh0QWN0aXZlXG4gICAgICB9XG4gICAgfVxuICAgIGxldCBidXR0b25BY3RpdmUgPSBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKTtcblxuICAgIGlmIChidXR0b25BY3RpdmUpIHtcbiAgICAgIHRleHQgPyBidXR0b24ucXVlcnlTZWxlY3Rvcignc3BhbicpLmlubmVySFRNTCA9IHRleHQuZGVmYXVsdCA6IG51bGw7XG4gICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgdGV4dCA/IGJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzcGFuJykuaW5uZXJIVE1MID0gdGV4dC5hY3RpdmUgOiBudWxsO1xuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgIH1cbiAgfSxcblxuICBkcm9wRG93bjogKGJ1dHRvbiwgdGFyZ2V0QmxvY2spID0+IHtcbiAgICBidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuICAgIHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCArICdweCcgOlxuICAgIHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7ICAgIFxuICB9LFxuXG4gIGFuaW1hdGVCbG9jazogZnVuY3Rpb24gKGJsb2NrKSB7XG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIHRoaXMucmVtb3ZlQ2xhc3NGcm9tKGJsb2NrLCAnanNfYW5pbWF0ZScpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7c2VsZi5hZGRDbGFzc1RvKGJsb2NrLCAnanNfYW5pbWF0ZScpIH0sIDUwKVxuICB9LFxuXG4gIGdldEN1cnJlbnRZUG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgfSxcblxuICBhZGRDbGFzc1RvOiBmdW5jdGlvbihlbGVtZW50LCBhY3RpdmVDbGFzcykge1xuICAgIHZhciBlbGVtID0gdGhpcy5yZXR1cm5ET00oZWxlbWVudCk7XG4gICAgaWYgKCFlbGVtLmNsYXNzTGlzdC5jb250YWlucyhhY3RpdmVDbGFzcykpIHtcbiAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZChhY3RpdmVDbGFzcyk7XG4gICAgfVxuICB9LFxuICByZW1vdmVDbGFzc0Zyb206IGZ1bmN0aW9uKGVsZW1lbnQsIGFjdGl2ZUNsYXNzKSB7XG4gICAgdmFyIGVsZW0gPSB0aGlzLnJldHVybkRPTShlbGVtZW50KTtcbiAgICBpZiAoZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XG4gICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoYWN0aXZlQ2xhc3MpO1xuICAgIH1cbiAgfSxcblxuICB0cmFuc2l0aW9uSGFuZGxlcjogZnVuY3Rpb24oZXZlbnQsIHRhcmdldEJsb2NrLCBoaWRkZW5Db250ZW50KSB7XG4gICAgaWYgKGV2ZW50LnByb3BlcnR5TmFtZSkge1xuICAgICAgY29uc29sZS5sb2coZXZlbnQucHJvcGVydHlOYW1lKSAgLy8geW91ciBjb2RlIGhlcmVcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQuc3JjRWxlbWVudCkge1xuICAgICAgY29uc29sZS5sb2coZXZlbnQuc3JjRWxlbWVudCkgIC8vIHlvdXIgY29kZSBoZXJlXG4gICAgfVxuICB9LFxuXG4gIGdldENoaWxkc1RvdGFsV2lkdGg6IGZ1bmN0aW9uKHBhcmVudCkge1xuICAgIGxldCBjaGlsZHJlbiA9IHBhcmVudC5jaGlsZHJlbjtcbiAgICBsZXQgcmVzdWx0ID0gMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCArIGNoaWxkcmVuW2ldLm9mZnNldFdpZHRoO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuXG4gIGdldENvb3Jkc09uUGFnZTogZnVuY3Rpb24oZWxlbWVudCkgeyBcbiAgICB2YXIgZWxlbSA9IHRoaXMucmV0dXJuRE9NKGVsZW1lbnQpO1xuICAgIHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogYm94LnRvcCArIHBhZ2VZT2Zmc2V0LFxuICAgICAgbGVmdDogYm94LmxlZnQgKyBwYWdlWE9mZnNldCxcbiAgICAgIGJvdHRvbTogYm94LmJvdHRvbSArIHBhZ2VZT2Zmc2V0XG4gICAgfTtcbiAgfSxcblxuICBnZXRDb29yZHNPblNjcmVlbjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHZhciBlbGVtID0gdGhpcy5yZXR1cm5ET00oZWxlbWVudCk7XG4gICAgdmFyIGJveCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiBib3gudG9wLFxuICAgICAgbGVmdDogYm94LmxlZnQsXG4gICAgICBib3R0b206IGJveC5ib3R0b20sXG4gICAgICByaWdodDogYm94LnJpZ2h0LFxuICAgICAgd2lkdGg6IGJveC53aWR0aCxcbiAgICAgIGhlaWdodDogYm94LmhlaWdodCxcbiAgICB9O1xuICB9LFxuXG4gIG9wZW5XaWR0aDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSBnZXRDaGlsZHNUb3RhbFdpZHRoKGVsZW1lbnQpICsgJ3B4JztcbiAgfSxcbiAgY29sbGFwc2VXaWR0aDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSAnMCc7XG4gIH0sXG5cbiAgaXNWaXNpYmxlOiBmdW5jdGlvbihlbGVtLCBvcHRpb24pIHtcbiAgICAvLyB2YXIgZWxlbSA9IHRoaXMucmV0dXJuRE9NKGVsZW1lbnQpO1xuICAgIGxldCBvcHQ7XG4gICAgb3B0aW9uID8gb3B0ID0gb3B0aW9uIDogb3B0ID0gXCJ3aG9sZVwiO1xuICAgIHZhciB3aW5kb3dUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgdmFyIHdpbmRvd0hlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgdmFyIGVsZW1QYWdlVG9wID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBwYWdlWU9mZnNldDtcbiAgICB2YXIgZWxlbVBhZ2VCb3R0b20gPSBlbGVtUGFnZVRvcCArIGVsZW0ub2Zmc2V0SGVpZ2h0O1xuXG4gICAgaWYgKG9wdCA9PSBcIndob2xlXCIpIHtcbiAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPiA5OTEpIHtcbiAgICAgICAgcmV0dXJuIChlbGVtUGFnZUJvdHRvbSA8PSB3aW5kb3dUb3AgKyB3aW5kb3dIZWlnaHQpICYmIChlbGVtUGFnZVRvcCA+PSB3aW5kb3dUb3ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICggZWxlbVBhZ2VUb3AgPD0gKHdpbmRvd1RvcCArIHdpbmRvd0hlaWdodCAvIDIpICkgJiYgKGVsZW1QYWdlVG9wID49IHdpbmRvd1RvcCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdCA9PSBcInRvcEJvcmRlclwiKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZyh3aW5kb3dUb3ApXG4gICAgICByZXR1cm4gKGVsZW1QYWdlVG9wID49IHdpbmRvd1RvcCArIDEzMCkgJiYgKGVsZW1QYWdlVG9wIDw9IHdpbmRvd1RvcCArIHdpbmRvd0hlaWdodCk7XG4gICAgfVxuXG4gICAgaWYgKG9wdCA9PSBcInRvcEJvcmRlckluXCIpIHtcbiAgICAgIHJldHVybiBlbGVtUGFnZVRvcCA8PSB3aW5kb3dUb3AgKyB3aW5kb3dIZWlnaHQ7XG4gICAgfVxuXG4gICAgaWYgKG9wdCA9PSBcImJvdHRvbUJvcmRlclwiKSB7XG4gICAgICAvLyByZXR1cm4gZWxlbVBhZ2VUb3AgPj0gd2luZG93VG9wICsgMTA7XG4gICAgfVxuICB9LFxuXG4gIGlzVmlzaWJsZU9uWEF4aXM6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudCkge1xuICAgIGxldCBpc1Zpc2libGVPbkxlZnQgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgPiBwYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcbiAgICBsZXQgaXNWaXNpYmxlT25SaWdodCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkucmlnaHQgPCBwYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkucmlnaHQ7XG4gICAgcmV0dXJuIGlzVmlzaWJsZU9uTGVmdCAmJiBpc1Zpc2libGVPblJpZ2h0O1xuICB9LFxuXG4gIGlzTGFzdENoaWxkOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nID8gZmFsc2UgOiB0cnVlO1xuICB9LFxuICBpc0ZpcnN0Q2hpbGQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nID8gZmFsc2UgOiB0cnVlO1xuICB9LFxufVxuLy8gPT09PT09PT09PT09PT09XG5cblxudmFyIHRlc3QgPSAnaW5jbHVkZSBqcyBlcnJvcic7XG5cbi8vIGltcG9ydCB7IGRyb3BEb3duIH0gZnJvbSAnLi9mcmFtZXMvZ2xvYmFsRnVuY3Rpb25zJ1xuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0Y29uc29sZS5sb2coJ2RvY3VtZW50IHJlYWR5Jylcblx0Ly8gY29uc29sZS5sb2coZHJvcERvd24pXHRcblx0Ly8gPT09PT09PT09PT09PT09PT1JbmNsdWRlIE1vZHVsZXM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXHR0ZXN0ID0gJ2luY2x1ZGUganMgLSBPSyc7XG5cblxuICAvKi8vIGNvbnNvbGUubG9nKCdQb3B1cE1vZHVsZSBvaycpO1xuLy8gPT09PT09PT09PT09PT1Qb3B1cCBPcGVuL0Nsb3NlIE1vZHVsZSA9PT09PT09PT09PT09PVxuZ2xvYi5Qb3B1cE1vZHVsZSA9IChmdW5jdGlvbiAoKSB7XG4gIHZhciBhZGRpdGlvbmFsQ2xhc3NTdHI7XG4gIGxldCBtb2RhbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwb3B1cCcpO1xuICBjb25zdCBwYWdlT3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlT3ZlcmxheScpO1xuXG5cbiAgZnVuY3Rpb24gdG9nZ2xlU2hvdyhldmVudCwgcG9wdXBCbG9jaykge1xuICAgIHZhciBwb3B1cCA9IGdsb2JGdW5jLnJldHVybkRPTShwb3B1cEJsb2NrKTtcblxuICAgIGlmICggZXZlbnQucHJvcGVydHlOYW1lID09ICd0cmFuc2Zvcm0nIHx8ICBldmVudC5wcm9wZXJ0eU5hbWUgPT0gJ29wYWNpdHknKSB7XG4gICAgICBwb3B1cC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX2FuaW1hdGUnKSA/IG51bGwgOiBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdqc19vcGVuJyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG1vZGFscy5sZW5ndGgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1vZGFscy5sZW5ndGg7IGkrKykge1xuICAgICAgbW9kYWxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB0b2dnbGVTaG93KGV2ZW50LCBtb2RhbHNbaV0pXG4gICAgICB9LCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb3BlblBvcHVwKHBvcHVwQmxvY2ssIGFkZGl0aW9uYWxDbGFzcywgb3ZlcmxheUJsb2NrKSB7XG4gICAgbGV0IG92ZXJsYXkgPSBvdmVybGF5QmxvY2sgfHwgcGFnZU92ZXJsYXk7XG5cbiAgICB2YXIgcG9wdXAgPSBnbG9iRnVuYy5yZXR1cm5ET00ocG9wdXBCbG9jayk7XG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJqc19vcGVuXCIpO1xuICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwianNfYW5pbWF0ZVwiKTtcblxuICAgIGlmIChhZGRpdGlvbmFsQ2xhc3MpIHtcbiAgICAgIGFkZGl0aW9uYWxDbGFzc1N0ciA9IGFkZGl0aW9uYWxDbGFzcztcbiAgICAgIGdsb2JGdW5jLnNob3dPdmVybGF5KFwicG9wdXBcIiwgb3ZlcmxheSwgYWRkaXRpb25hbENsYXNzKSBcbiAgICB9IGVsc2Uge1xuICAgICAgZ2xvYkZ1bmMuc2hvd092ZXJsYXkoXCJwb3B1cFwiLCBvdmVybGF5KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwQmxvY2spIHtcbiAgICAvLyBsZXQgb3ZlcmxheSA9IG92ZXJsYXlCbG9jayB8fCBwYWdlT3ZlcmxheTtcbiAgICB2YXIgcG9wdXAgPSBnbG9iRnVuYy5yZXR1cm5ET00ocG9wdXBCbG9jayk7XG4gICAgXG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcImpzX2FuaW1hdGVcIik7XG4gICAgLy8gcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcImpzX29wZW5cIik7XG4gICAgLy8gYWRkaXRpb25hbENsYXNzID8gaGlkZU92ZXJsYXkoXCJwb3B1cFwiLCBvdmVybGF5LCBhZGRpdGlvbmFsQ2xhc3MpIDogaGlkZU92ZXJsYXkoXCJwb3B1cFwiLCBvdmVybGF5KTtcbiAgfVxuXG4gIC8vIC0tLS0tLS1FdmVudHMtLS0tLS0tLSAgXG5cbiAgJCgnYm9keScpLm9uKCdjbGljaycsICcjcGFnZU92ZXJsYXknLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gY29uc29sZS5sb2coZSlcbiAgICBnbG9iRnVuYy5oaWRlT3ZlcmxheShcInBvcHVwXCIsIHRoaXMsIGFkZGl0aW9uYWxDbGFzc1N0cik7XG5cbiAgICBpZiAobW9kYWxzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICBtb2RhbHNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuJykgPyBjbG9zZVBvcHVwKG1vZGFsc1tpXSkgOiBudWxsO1xuICAgICAgfSAgICAgICBcbiAgICB9XG4gIH0pO1xuICAgXG4gICQoJ2JvZHknKS5vbignY2xpY2snLCAnYnV0dG9uLnBvcHVwQ2xvc2VCdXR0b24nLCBmdW5jdGlvbigpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnb2snKVxuXG4gICAgY2xvc2VQb3B1cCggJCh0aGlzKS5jbG9zZXN0KCcucG9wdXAnKSApO1xuICAgIGdsb2JGdW5jLmhpZGVPdmVybGF5KFwicG9wdXBcIiwgcGFnZU92ZXJsYXksIGFkZGl0aW9uYWxDbGFzc1N0cik7XG4gIH0pO1xuXG4gICQoJ2JvZHknKS5vbignbW91c2Vkb3duJywgJy5wb3B1cCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhlLnRhcmdldClcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cCcpKSB7XG4gICAgICBjbG9zZVBvcHVwKCBlLnRhcmdldCApO1xuICAgICAgZ2xvYkZ1bmMuaGlkZU92ZXJsYXkoXCJwb3B1cFwiLCBwYWdlT3ZlcmxheSwgYWRkaXRpb25hbENsYXNzU3RyKTtcbiAgICB9XG4gIH0pO1xuXG4gIHdpbmRvdy5vbmtleWRvd24gPSBmdW5jdGlvbiAoZSkge1xuICAgIGlmIChlLmtleUNvZGUgPT09IDI3ICkge1xuICAgICAgaWYgKHBhZ2VPdmVybGF5KSB7XG4gICAgICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlbicpID8gZ2xvYkZ1bmMuaGlkZU92ZXJsYXkoXCJwb3B1cFwiLCBwYWdlT3ZlcmxheSwgYWRkaXRpb25hbENsYXNzU3RyKSA6IG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb2RhbHMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2RhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBtb2RhbHNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuJykgPyBjbG9zZVBvcHVwKG1vZGFsc1tpXSkgOiBudWxsO1xuICAgICAgICB9ICAgICAgIFxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyAtLS0tLS0tLS0tLS1cblxuICByZXR1cm4ge1xuICAgIG9wZW5Qb3B1cDogb3BlblBvcHVwLFxuICAgIGNsb3NlUG9wdXA6IGNsb3NlUG9wdXAsXG4gIH1cblxufSkoKTtcblxuLy8gZ2xvYi5Qb3B1cE1vZHVsZSgpXG5cbi8vIChmdW5jdGlvbigpIHtcblxuXG5cbi8vIH0pLmNhbGwoZ2xvYi5Qb3B1cE1vZHVsZS5wcm90b3R5cGUpKi9cbiAgLypWYWxpZGF0aW9uTW9kdWxlID0gKGZ1bmN0aW9uKCkge1xuXHRmdW5jdGlvbiB2YWxpZGF0ZShpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25zQXJyYXkpIHtcblx0XHRjb25zdCB2YWxpZGF0aW9ucyA9IHZhbGlkYXRpb25zQXJyYXk7XG5cdFx0bGV0IG1lc3NhZ2VzID0gW107XG5cblx0XHRmdW5jdGlvbiBpc051bWJlcihpbnB1dCkge1xuXHRcdFx0cmV0dXJuICFpc05hTihwYXJzZUZsb2F0KGlucHV0LnZhbHVlKSkgJiYgaXNGaW5pdGUoaW5wdXQudmFsdWUpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGlzRW1haWwoaW5wdXQpIHtcblx0XHRcdHZhciByZWdleCA9IC9eKFthLXpBLVowLTlfListXSkrXFxAKChbYS16QS1aMC05LV0pK1xcLikrKFthLXpBLVowLTldezIsNH0pKyQvO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gcmVnZXgudGVzdChpbnB1dC52YWx1ZSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gaXNFbXB0eShpbnB1dCkge1xuXHRcdFx0cmV0dXJuIGlucHV0LnZhbHVlLnJlcGxhY2UoL1xccy9nLFwiXCIpLmxlbmd0aCA/IGZhbHNlIDogdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRhdGlvbnMubGVuZ3RoOyBpKyspIHtcblxuXHRcdFx0c3dpdGNoICh2YWxpZGF0aW9uc1tpXSkge1xuXHRcdFx0XHRjYXNlICdyZXF1aXJlZCc6IFxuXHRcdFx0XHRcdGlmICggaXNFbXB0eShpbnB1dEVsZW1lbnQpICkge1xuXHRcdFx0XHRcdFx0bWVzc2FnZXMucHVzaChpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvclRleHQpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdpc051bWJlcic6IFxuXHRcdFx0XHRcdGlmICggIWlzTnVtYmVyKGlucHV0RWxlbWVudCkgKSB7XG5cdFx0XHRcdFx0XHRtZXNzYWdlcy5wdXNoKGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yVGV4dClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ2lzRW1haWwnOiBcblx0XHRcdFx0XHRpZiAoICFpc0VtYWlsKGlucHV0RWxlbWVudCkgKSB7XG5cdFx0XHRcdFx0XHRtZXNzYWdlcy5wdXNoKGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yVGV4dCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdpbnZhbGlkIGlucHV0IGRhdGEtdmFsaWRhdGUgdmFsdWUnKVxuXG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKG1lc3NhZ2VzLmxlbmd0aCA/IG1lc3NhZ2VzIDogbnVsbClcblx0XHRyZXR1cm4gbWVzc2FnZXMubGVuZ3RoID8gbWVzc2FnZXMgOiBudWxsO1xuXHR9XG5cblx0ZnVuY3Rpb24gc2hvd1dhcm5pbmcoaW5wdXRFbGVtZW50LCBtZXNzYWdlcywgdGV4dENvbG9yKSB7XG5cdFx0aW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX2NvbnRhaW5zRXJyb3InKTtcblx0XHRsZXQgd2FybmluZ0xpc3QgPSAkKCc8dWwgY2xhc3M9XCJqc193YXJuaW5nLWxpc3RcIj48L3VsPicpO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGxpc3RFbGVtZW50ID0gJChcIjxsaT48L2xpPlwiKS50ZXh0KG1lc3NhZ2VzW2ldKTtcblx0XHRcdHRleHRDb2xvciA/IGxpc3RFbGVtZW50LmNzcygnY29sb3InLCB0ZXh0Q29sb3IpIDogbnVsbDtcblx0XHRcdHdhcm5pbmdMaXN0LmFwcGVuZChsaXN0RWxlbWVudClcblx0XHR9XG5cdFx0XG5cdFx0JChpbnB1dEVsZW1lbnQpLmFmdGVyKHdhcm5pbmdMaXN0KVxuXHR9XG5cblx0ZnVuY3Rpb24gaXNWYWxpZChmb3JtRWxlbWVudCkge1xuXHRcdGNvbnN0IGZvcm0gPSBmb3JtRWxlbWVudCBpbnN0YW5jZW9mIGpRdWVyeSA/IGZvcm1FbGVtZW50WzBdIDogZm9ybUVsZW1lbnQ7XG5cdFx0Y29uc3QgaW5wdXRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS12YWxpZGF0ZV0nKTtcblx0XHRsZXQgZXJyb3JzQ291bnRlciA9IDA7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGVycm9yTWVzc2FnZXMgPSBbXTtcblx0XHRcdGxldCB0ZXh0Q29sb3IgPSBpbnB1dHNbaV0uZGF0YXNldC50ZXh0Q29sb3I7XG5cblx0XHRcdCQoaW5wdXRzW2ldKS5yZW1vdmVDbGFzcyhcImpzX2NvbnRhaW5zRXJyb3JcIik7XG5cdFx0XHQkKGlucHV0c1tpXSkubmV4dCgnLmpzX3dhcm5pbmctbGlzdCcpLnJlbW92ZSgpO1xuXG5cdFx0XHRsZXQgdmFsaWRhdGlvbnNBcnJheSA9IFtdO1xuXHRcdFx0bGV0IGlucHV0RGF0YSA9IGlucHV0c1tpXS5kYXRhc2V0LnZhbGlkYXRlID8gaW5wdXRzW2ldLmRhdGFzZXQudmFsaWRhdGUuc3BsaXQoJyAnKSA6IGZhbHNlO1xuXG5cdFx0XHQvLyAtLS0tLS0tLS1cblx0XHRcdGlucHV0c1tpXS52YWx1ZSA9IGlucHV0c1tpXS52YWx1ZS50cmltKCk7XG5cdFx0XHQvLyAtLS0tLS0tLS1cblxuXHRcdFx0dmFsaWRhdGlvbnNBcnJheSA9IGlucHV0RGF0YSA/IGlucHV0RGF0YSA6IG51bGw7XG5cdFx0XHQvLyBpbnB1dHNbaV0ucmVxdWlyZWQgPyB2YWxpZGF0aW9uc0FycmF5LnB1c2goJ3JlcXVpcmVkJykgOiBudWxsO1xuXHRcdFx0XG5cdFx0XHRpZiAodmFsaWRhdGlvbnNBcnJheS5sZW5ndGgpIHtcblx0XHRcdFx0bGV0IHZhbGlkYXRpb25SZXN1bHQgPSB2YWxpZGF0ZShpbnB1dHNbaV0sIHZhbGlkYXRpb25zQXJyYXkpO1xuXHRcdFx0XHR2YWxpZGF0aW9uUmVzdWx0ID8gZXJyb3JNZXNzYWdlcyA9IHZhbGlkYXRpb25SZXN1bHQgOiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXJyb3JNZXNzYWdlcy5sZW5ndGgpIHsgXG5cdFx0XHRcdHNob3dXYXJuaW5nKGlucHV0c1tpXSwgZXJyb3JNZXNzYWdlcywgdGV4dENvbG9yKTtcblx0XHRcdFx0ZXJyb3JzQ291bnRlcisrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBlcnJvcnNDb3VudGVyID4gMCA/IGZhbHNlIDogdHJ1ZTtcblx0fVxuXG5cdC8vIC0tLS0tLS0tLS0tLS0tLVxuXHRyZXR1cm4ge1xuXHRcdGlzVmFsaWQ6IGlzVmFsaWQsXG5cdH1cbn0pKClcblxuLy8gLS0tLS0tLS0tVmFsaWRhdGlvbiBTY3JpcHQgVGVzdC0tLS0tLS0tLS0tLS1cblxuLy8gJCgnYm9keScpLm9uKCdjbGljaycsICdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScsIGZ1bmN0aW9uKGUpIHtcbi8vIFx0Ly8gY29uc29sZS5sb2coJ29rJylcbi8vIFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4vLyBcdC8vIFZhbGlkYXRpb25Nb2R1bGUuaXNWYWxpZCh0aGlzLmZvcm0pXG4vLyBcdGlmKCAhVmFsaWRhdGlvbk1vZHVsZS5pc1ZhbGlkKHRoaXMuZm9ybSkgKSB7XG4vLyBcdFx0Y29uc29sZS5sb2coJ2Zvcm0gbm90IHZhbGlkOiAnLCB0aGlzLmZvcm0pXG4vLyBcdH0gZWxzZSB7XG4vLyBcdFx0Y29uc29sZS5sb2coJ2Zvcm0gdmFsaWQ6ICcsIHRoaXMuZm9ybSlcbi8vIFx0fVxuLy8gfSkqL1xuXHQvKmdsb2IuQW5pbWF0ZUJvcmRlciA9IGZ1bmN0aW9uIChhbmltYXRlZEJsb2Nrcywgb3B0aW9uc09iaikge1xuXG5cdHZhciBhbmltYXRlZERhc2hCbG9ja3MgPSBhbmltYXRlZEJsb2Nrcztcblx0dmFyIG9wdGlvbnMgPSBvcHRpb25zT2JqO1xuXG5cdC8vIGNvbnNvbGUubG9nKG9wdGlvbnMuc2hhZGVkU2VjdGlvbik7XG5cdC8vIC0tLS0tLS0tLS0gTWV0aG9kcyAtLS0tLS0tLVxuXG5cdGZ1bmN0aW9uIGdldFRvdGFsTGVuZ3RoKHBhcmVudEJsb2NrLCByZWN0KSB7XG5cdFx0Ly8gdmFyIHJhZGl1cyA9ICtyZWN0LmdldEF0dHJpYnV0ZSgncngnKTtcblx0XHR2YXIgbGVuZ3RoID0gMDtcblx0XHR2YXIgcmVjdFdpZHRoID0gcGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggLSAob3B0aW9ucy5ib3JkZXJXaWR0aCAqIDIpO1xuXHRcdHZhciByZWN0SGVpZ2h0ID0gcGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gKG9wdGlvbnMuYm9yZGVyV2lkdGggKiAyKTtcblx0XHR2YXIgcmFkaXVzID0gb3B0aW9ucy5yYWRpdXMgPyByZWN0SGVpZ2h0IC8gMiA6IG51bGw7XG5cdFx0Ly8gY29uc29sZS5sb2cocGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgpXG5cdFx0aWYgKHJhZGl1cykge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0bGVuZ3RoOiArKCAocmVjdFdpZHRoIC0gcmFkaXVzKjIpICogMiApICsgKCAyKjMuMTQgKiByYWRpdXMgKSxcblx0XHRcdFx0cmFkaXVzOiByYWRpdXNcblx0XHRcdH0gXG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGxlbmd0aDogKyggcmVjdFdpZHRoICsgcmVjdEhlaWdodCApICogMlxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGdldERhc2hBcnJheVN0cmluZyhyZWN0LCByZWN0TGVuZ3RoKSB7XG5cdFx0dmFyIGRhc2hUb3RhbExlbmd0aCA9IG9wdGlvbnMuc2hhZGVkU2VjdGlvbiArIG9wdGlvbnMudHJhbnNwYXJlbnRTZWN0aW9uO1xuXG5cdFx0dmFyIGRhc2hRdWFudGl0eSA9IE1hdGgucm91bmQoIHJlY3RMZW5ndGggLyBkYXNoVG90YWxMZW5ndGggKVxuXHRcdHZhciBkaWZmZXJlbmNlID0gKCBkYXNoVG90YWxMZW5ndGgqZGFzaFF1YW50aXR5IC0gcmVjdExlbmd0aCApIC8gZGFzaFF1YW50aXR5O1xuXHRcdFxuXHRcdGRpZmZlcmVuY2UgPSAoIE1hdGgucm91bmQoZGlmZmVyZW5jZSAqIDEwKSAvIDEwICkgLyAyO1xuXG5cdFx0b3B0aW9ucy5uZXdTaGFkZWRTZWN0aW9uID0gb3B0aW9ucy5zaGFkZWRTZWN0aW9uIC0gZGlmZmVyZW5jZTtcblx0XHRvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbiA9IG9wdGlvbnMudHJhbnNwYXJlbnRTZWN0aW9uIC0gZGlmZmVyZW5jZTtcblxuXHRcdHJldHVybiBvcHRpb25zLm5ld1NoYWRlZFNlY3Rpb24gKyAnICcgKyBvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbjtcblx0fVxuXG5cdGZ1bmN0aW9uIGN5Y2xlT2Zmc2V0KGV2ZW50LCBhbmltYXRlZEJsb2NrLCBkYXNoQXJyYXlTdW1OdW1iZXIpIHtcblx0ICBpZiAoIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAnc3Ryb2tlLWRhc2hvZmZzZXQnICkge1xuXHQgIFx0Ly8gY29uc29sZS5sb2coJ3N0cm9rZS1kYXNob2Zmc2V0Jylcblx0ICBcdGFuaW1hdGVkQmxvY2suY2xhc3NMaXN0LmFkZCgnanNfcmVzZXRUcmFuc2l0aW9uJyk7XG5cdCAgXHRhbmltYXRlZEJsb2NrLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCAwKTtcblx0ICBcdFxuXHQgIFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICBcdFx0YW5pbWF0ZWRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19yZXNldFRyYW5zaXRpb24nKTtcblx0ICBcdFx0YW5pbWF0ZWRCbG9jay5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNob2Zmc2V0JywgZGFzaEFycmF5U3VtTnVtYmVyKVx0XHRcdFxuXHQgIFx0fSwgMTApXG5cdCAgfVxuXHR9XG5cblx0dmFyIGV2ZW50SGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0Ly8gY29uc29sZS5sb2coJ2V2ZW50OiAnKVxuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdGN5Y2xlT2Zmc2V0KGV2ZW50LCB0aGlzLCB0aGlzLmRhdGFzZXQuZGFzaEFycmF5U3VtKVxuXHR9XG5cblx0Ly8gLS0tLS0tLS0tLSBBY3Rpb24gLS0tLS0tLS1cblxuXHRpZiAoYW5pbWF0ZWREYXNoQmxvY2tzLmxlbmd0aCkge1xuXG5cdFx0dmFyIGluaXQgPSBmdW5jdGlvbigpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbWF0ZWREYXNoQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciByZWN0ID0gYW5pbWF0ZWREYXNoQmxvY2tzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QuYW5pbWF0ZWRCbG9jaycpO1xuXHRcdFx0XHR2YXIgdG90YWxMZW5ndGggPSAwLCByZXN1bHREYXNoQXJyYXlTdHJpbmcgPSAnJywgZGFzaEFycmF5U3VtID0gMCwgcmFkaXVzID0gMDtcblx0XHRcdFx0XG5cdFx0XHRcdHJlY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZXZlbnRIYW5kbGVyKTtcblxuXHRcdFx0XHR0b3RhbExlbmd0aCA9IGdldFRvdGFsTGVuZ3RoKCBhbmltYXRlZERhc2hCbG9ja3NbaV0sIHJlY3QgKTtcblx0XHRcdFx0cmFkaXVzID0gdG90YWxMZW5ndGgucmFkaXVzO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyh0b3RhbExlbmd0aC5sZW5ndGgpXG5cdFx0XHRcdHJlc3VsdERhc2hBcnJheVN0cmluZyA9IGdldERhc2hBcnJheVN0cmluZyhyZWN0LCB0b3RhbExlbmd0aC5sZW5ndGgpO1xuXHRcdFx0XHRkYXNoQXJyYXlTdW0gPSBNYXRoLnJvdW5kKCBvcHRpb25zLm5ld1NoYWRlZFNlY3Rpb24gKyBvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbiApO1xuXHRcdFx0XHRkYXNoQXJyYXlTdW0gPSBvcHRpb25zLnJldmVyc2UgPyBkYXNoQXJyYXlTdW0gOiBkYXNoQXJyYXlTdW0gKiAtMTtcblxuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgb3B0aW9ucy5ib3JkZXJXaWR0aCk7XG5cdFx0XHRcdHJhZGl1cyA/IHJlY3Quc2V0QXR0cmlidXRlKCdyeCcsIHJhZGl1cykgOiBudWxsO1xuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hhcnJheScsIHJlc3VsdERhc2hBcnJheVN0cmluZyk7XG5cdFx0XHRcdHJlY3Quc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaG9mZnNldCcsIGRhc2hBcnJheVN1bSoyKTtcblx0XHRcdFx0cmVjdC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGFzaEFycmF5U3VtJywgZGFzaEFycmF5U3VtKjIpO1xuXG5cdFx0XHRcdHJlY3QuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZXZlbnRIYW5kbGVyKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpbml0KCk7XG5cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR2YXIgdGltZXIgPSBudWxsO1xuXHRcdHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0ICBpZiAodGltZXIpIHsgY2xlYXJUaW1lb3V0KHRpbWVyKTsgfVxuXG5cdFx0ICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0ICAgIHRpbWVyID0gbnVsbDtcblxuXHRcdCAgICAvLyB5b3VyIGV2ZW50IGhhbmRsaW5nIGxvZ2ljIGhlcmVcblx0XHQgICAgLy8gY29uc29sZS5sb2coJ3Jlc2l6ZScpXG5cdFx0ICAgIGluaXQoKVxuXG5cdFx0ICB9LCA1MCk7XG5cdFx0fTtcblxuXHR9XG5cbn1cblxuKi9cbiAgLyovLyBqUXVlcnkoJzxkaXYgY2xhc3M9XCJxdWFudGl0eS1uYXZcIj48ZGl2IGNsYXNzPVwicXVhbnRpdHktYnV0dG9uIHF1YW50aXR5LXVwXCI+PC9kaXY+PGRpdiBjbGFzcz1cInF1YW50aXR5LWJ1dHRvbiBxdWFudGl0eS1kb3duXCI+PC9kaXY+PC9kaXY+JykuaW5zZXJ0QWZ0ZXIoJy5xdWFudGl0eSBpbnB1dCcpO1xualF1ZXJ5KCcuY3VzdG9tLXF1YW50aXR5JykuZWFjaChmdW5jdGlvbigpIHtcbiAgdmFyIHNwaW5uZXIgPSBqUXVlcnkodGhpcyksXG4gIGlucHV0ID0gc3Bpbm5lci5maW5kKCdpbnB1dFt0eXBlPVwibnVtYmVyXCJdJyksXG4gIGJ0blVwID0gc3Bpbm5lci5maW5kKCcucXVhbnRpdHktdXAnKSxcbiAgYnRuRG93biA9IHNwaW5uZXIuZmluZCgnLnF1YW50aXR5LWRvd24nKSxcbiAgbWluID0gaW5wdXQuYXR0cignbWluJyksXG4gIG1heCA9IGlucHV0LmF0dHIoJ21heCcpO1xuXG4gIGJ0blVwLmNsaWNrKGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIG9sZFZhbHVlID0gcGFyc2VGbG9hdChpbnB1dC52YWwoKSk7XG4gICAgaWYgKG9sZFZhbHVlID49IG1heCkge1xuICAgICAgICB2YXIgbmV3VmFsID0gb2xkVmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG9sZFZhbHVlICsgMTtcbiAgICB9XG5cbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS52YWwobmV3VmFsKTtcblxuICAgIHNwaW5uZXIuZmluZChcImlucHV0XCIpLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG5cbiAgfSk7XG5cbiAgYnRuRG93bi5jbGljayhmdW5jdGlvbigpIHtcblxuICAgIHZhciBvbGRWYWx1ZSA9IHBhcnNlRmxvYXQoaW5wdXQudmFsKCkpO1xuICAgIGlmIChvbGRWYWx1ZSA8PSBtaW4pIHtcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG9sZFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZSAtIDE7XG4gICAgfVxuICAgIHNwaW5uZXIuZmluZChcImlucHV0XCIpLnZhbChuZXdWYWwpO1xuICAgIHNwaW5uZXIuZmluZChcImlucHV0XCIpLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gIH0pO1xuXG59KTsqL1xuICAvKmdsb2IuQWNjb3JkaW9uTW9kdWxlICA9IChmdW5jdGlvbigpIHtcblx0Ly8gY29uc29sZS5sb2coJ0FjY29yZGlvbk1vZHVsZSBvaycpO1xuXHRcblx0ZnVuY3Rpb24gdG9nZ2xlQ29udGVudChvcHRpb25zLCBidXR0b24sIHRhcmdldEJsb2NrLCBhbGxUYXJnZXRCbG9ja3MpIHtcblx0XHRsZXQgc3ViTWVudVBhcmVudHMgPSBidXR0b24gPyBmaW5kQWxsUGFyZW50cyhidXR0b24sICdzdWJtZW51V3JhcHBlcicpIDogbnVsbDtcblx0XHRsZXQgdGFyZ2V0SGVpZ2h0ID0gdGFyZ2V0QmxvY2sgPyB0YXJnZXRCbG9jay5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQgOiBudWxsO1xuXG5cdFx0Ly8gY29uc29sZS5sb2coc3ViTWVudVBhcmVudHMpXG5cblx0XHRmdW5jdGlvbiBmaW5kQWxsUGFyZW50cyhlbGVtZW50LCBzZWFyY2hDbGFzcykge1xuXHRcdFx0dmFyIGZpbmRlZCA9IGZhbHNlO1xuXHRcdFx0dmFyIGN1cnJlbnRFbGVtZW50ID0gZWxlbWVudCwgZmluZGluZ0VsZW1lbnRzID0gW107XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR3aGlsZSghZmluZGVkKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKGN1cnJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQpXG5cdFx0XHRcdFx0dmFyIHBhcmVudCA9IGN1cnJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG5cblx0XHRcdFx0XHRpZiAoIHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoc2VhcmNoQ2xhc3MpICkge1xuXHRcdFx0XHRcdFx0ZmluZGluZ0VsZW1lbnRzLnB1c2gocGFyZW50KTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ21haW5TdWJtZW51V3JhcHBlcicpKSB7XG5cdFx0XHRcdFx0XHRmaW5kZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0ZmluZGluZ0VsZW1lbnRzLnB1c2goY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudCk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjY29yZGlvbk1lbnUnKSkgYnJlYWs7XG5cdFx0XHRcdFx0Y3VycmVudEVsZW1lbnQgPSBwYXJlbnQ7XG5cdFx0XHRcdH1cdFx0XHRcdFxuXHRcdFx0fSBjYXRjaChlcnJvcikge2NvbnNvbGUubG9nKGVycm9yKX1cblxuXHRcdFx0Ly8gY29uc29sZS5sb2coY3VycmVudEVsZW1lbnQpXG5cdFx0XHRyZXR1cm4gZmluZGluZ0VsZW1lbnRzO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlc2V0RHJvcERvd24odGFyZ2V0RWxlbWVudHMpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0uc3R5bGUuaGVpZ2h0ID0gXCJcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjbG9zZVNpYmxpbmdzKGJ1dHRvbiwgdGFyZ2V0RWxlbWVudHMpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0bGV0IGJ1dHRvbiA9IHRhcmdldEVsZW1lbnRzW2ldLnBhcmVudEVsZW1lbnRcblx0XHRcdFx0aWYgKGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpICkge1xuXHRcdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGRyb3BEb3duKGJ1dHRvbiwgdGFyZ2V0RWxlbWVudCwgc3ViTWVudVBhcmVudHMpIHtcblx0XHRcdGlmICggYnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgKSB7XG5cdFx0XHRcdGlmIChzdWJNZW51UGFyZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHN1Yk1lbnVQYXJlbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRzdWJNZW51UGFyZW50c1tpXS5zdHlsZS5oZWlnaHQgPSBzdWJNZW51UGFyZW50c1tpXS5vZmZzZXRIZWlnaHQgKyB0YXJnZXRIZWlnaHQgKyAncHgnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHR0YXJnZXRFbGVtZW50LnN0eWxlLmhlaWdodCA9IHRhcmdldEhlaWdodCArICdweCdcblx0XHRcdH0gZWxzZSB7XHRcdFx0IFxuXHRcdFx0XHR0YXJnZXRFbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc3ViTWVudVBhcmVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRzdWJNZW51UGFyZW50c1tpXS5zdHlsZS5oZWlnaHQgPSAgc3ViTWVudVBhcmVudHNbaV0ub2Zmc2V0SGVpZ2h0IC0gdGFyZ2V0SGVpZ2h0ICsgJ3B4Jztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXG5cdFx0c3dpdGNoIChvcHRpb25zICB8fCAnZGVmYXVsdCcpIHtcblxuXHRcdFx0Y2FzZSAnd2l0aFNpYmxpbmdzJzogXG5cdFx0XHRcdGNsb3NlU2libGluZ3MoYnV0dG9uLCBhbGxUYXJnZXRCbG9ja3MpO1xuXHRcdFx0XHRkcm9wRG93bihidXR0b24sIHRhcmdldEJsb2NrLCBzdWJNZW51UGFyZW50cyk7XG5cdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAnd2l0aG91dFNpYmxpbmdzJzogZHJvcERvd24oYnV0dG9uLCB0YXJnZXRCbG9jaywgc3ViTWVudVBhcmVudHMpOyBicmVhaztcblxuXHRcdFx0Y2FzZSAncmVzZXREcm9wRG93bic6IHJlc2V0RHJvcERvd24oYWxsVGFyZ2V0QmxvY2tzKTsgYnJlYWs7XG5cblx0XHRcdGRlZmF1bHQ6IGNvbnNvbGUuZXJyb3IoJ25vIGNvcnJlY3Qgb3B0aW9uIHR5cGVkIGluIHRvZ2dsZUNvbnRlbnQgZnVuY3Rpb24nKTtcblxuXHRcdH1cblxuXHR9XG4gICAgXG5cdC8vIC0tLS0tUmVzaXplIEV2ZW50LS0tLS0tXG5cdC8vIGNvbnN0IG1vYmlsZUZpbHRlck1lbnVCbG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjZmlsdGVyV3JhcHBlciAuZmlsdGVyLWl0ZW0gLmZpbHRlci1jb250ZW50LXdyYXBwZXInKTtcblxuXHQvLyBsZXQgdGltZXIgPSBudWxsO1xuXG5cdC8vIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcblx0Ly8gXHRpZiAodGltZXIpIHtcblx0Ly8gXHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdC8vIFx0fVxuXG5cdC8vIFx0dGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQvLyBcdFx0dGltZXIgPSBudWxsO1xuXG4gLy8gICAgIC8vID09PT09PT1IYW5kbGVycz09PT09PT1cbiAvLyAgICAgIGlmIChtb2JpbGVGaWx0ZXJNZW51QmxvY2tzKSB7XG4gLy8gICAgICBcdGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPiA5OTEpIHtcblx0Ly8gXHRcdFx0XHR0b2dnbGVDb250ZW50KFwicmVzZXREcm9wRG93blwiLCBudWxsLCBudWxsLCBtb2JpbGVGaWx0ZXJNZW51QmxvY2tzKTtcblx0Ly8gXHRcdFx0fVxuIC8vICAgICAgfVxuIC8vICAgICB9LCA1MCk7XG5cdC8vIH07XG5cblx0XG4vLyAtLS0tLS0tLS0tLS1cblxuXHRyZXR1cm4ge1xuXHRcdHRvZ2dsZUNvbnRlbnQ6IHRvZ2dsZUNvbnRlbnQsXG5cdH1cblxufSkoKSovXG4gIC8qZ2xvYi5Ub2dnbGVDb250ZW50TW9kdWxlICA9IChmdW5jdGlvbigpIHtcblx0Ly8gY29uc29sZS5sb2coJ1RvZ2dsZUNvbnRlbnRNb2R1bGUgb2snKTtcblx0Ly8gY29uc29sZS50aW1lKCdUb2dnbGVDb250ZW50IE1vZHVsZSBsb2FkJyk7XG5cblx0ZnVuY3Rpb24gdG9nZ2xlQ29udGVudChidXR0b25FbGVtZW50LCBkYXRhKSB7XG5cdFx0bGV0IGJ1dHRvbiA9IGJ1dHRvbkVsZW1lbnQsXG5cdFx0XHRcdGJ1dHRvbkRhdGEgPSBkYXRhLmJ1dHRvbkRhdGEsXG5cdFx0XHRcdHRhcmdldHMgPSBkYXRhLnRhcmdldHMsXG5cdFx0XHRcdHRoaXNUYXJnZXQgPSBkYXRhLnRoaXNDb250ZW50LFxuXHRcdFx0XHR0YXJnZXRCdXR0b25zID0gZGF0YS50YXJnZXRCdXR0b25zLFxuXHRcdFx0XHR0YXJnZXRzUmV2ZXJzZSA9IGRhdGEudGFyZ2V0c1JldmVyc2U7XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKGRhdGEpXG5cblx0XHRcblx0XHQvLyAtLS0tLS1NZXRob2RzLS0tLS0tLS1cblxuXHRcdGZ1bmN0aW9uIGRyb3BEb3duKGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFjdGlvbiwgYnV0dG9uc0VsZW1lbnRzKSB7XG5cdFx0XHRpZiAoYWN0aW9uID09PSAnc2hvdycgKSB7XG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCArICdweCcgOlxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xuXHRcdFx0fVx0ZWxzZSBpZiAoYWN0aW9uID09PSAnaGlkZVJldmVyc2UnKSB7XG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IFwiMHB4XCIgOlxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSB0YXJnZXRCbG9jay5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzaG93SGlkZShidXR0b24sIHRhcmdldEJsb2NrLCBhY3Rpb24sIGNzc1Nob3dDbGFzcywgY3NzSGlkZUNsYXNzKSB7XG5cdFx0XHRpZiAoYWN0aW9uID09PSAnc2hvdycgKSB7XG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdFx0dGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZChjc3NTaG93Q2xhc3MpIDogdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZShjc3NTaG93Q2xhc3MpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgP1xuXHRcdFx0XHRcdHRhcmdldEJsb2NrLmNsYXNzTGlzdC5hZGQoY3NzSGlkZUNsYXNzKSA6IHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoY3NzSGlkZUNsYXNzKTtcblx0XHRcdH1cdFxuXHRcdH1cblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdGZ1bmN0aW9uIGNsZWFuQnV0dG9ucyh0YXJnZXRFbGVtZW50cykge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykgOiBudWxsO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHRvZ2dsZSh0YXJnZXRCbG9ja3MsIGFjdGlvbikge1xuXHRcdFx0Ly8gY29uc29sZS5sb2codGFyZ2V0QmxvY2tzKVxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0c3dpdGNoIChidXR0b25EYXRhLm1lbnVUeXBlIHx8ICdkZWZhdWx0Jykge1xuXHRcdFx0XHRcdGNhc2UgJ3NjYWxlJzogc2hvd0hpZGUoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24sICdqc19zaG93U2NhbGUnLCAnanNfaGlkZVNjYWxlJyApOyBicmVhaztcblx0XHRcdFx0XHRjYXNlICdkcm9wLWRvd24nOiBkcm9wRG93biggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiApOyBicmVhaztcblx0XHRcdFx0XHRjYXNlICdkcm9wLWxlZnQnOiBzaG93SGlkZSggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiwgJ2pzX3Nob3dTbGlkZV9sZWZ0JywgJ2pzX2hpZGVTbGlkZV9sZWZ0Jyk7IGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2Ryb3AtcmlnaHQnOiBzaG93SGlkZSggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiwgJ2pzX3Nob3dTbGlkZV9yaWdodCcsICdqc19oaWRlU2xpZGVfcmlnaHQnKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnc2hvdy1oaWRlJzogc2hvd0hpZGUoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24sICdqc19zaG93JywgJ2pzX2hpZGUnICk7IGJyZWFrO1xuXG5cdFx0XHRcdFx0ZGVmYXVsdDogY29uc29sZS5lcnJvcignbm8gY29ycmVjdCBcImRhdGEtbWVudS10eXBlXCIgYXR0cmlidXRlIGlzIHNldCB0byB0aGUgYnV0dG9uIGVsZW1lbnQgaW4gSFRNTCEnKTtcblx0XHRcdFx0fVx0XHRcdFx0XHRcdFxuXHRcdFx0fSAgICAgIFxuXHRcdH1cblxuXG5cdFx0c3dpdGNoIChidXR0b25EYXRhLmJ1dHRvblR5cGUgfHwgJ2RlZmF1bHQnKSB7XG5cdFx0XHRjYXNlICdjaGVja2JveCc6XG5cdFx0XHRjYXNlICdidXR0b24nOlxuXHRcdFx0Y2FzZSAnbWVudUJ1dHRvbic6XG5cdFx0XHRcdFx0dG9nZ2xlKHRhcmdldHMsICdzaG93Jyk7XG5cdFx0XHRcdFx0dG9nZ2xlKHRhcmdldHNSZXZlcnNlLCAnaGlkZVJldmVyc2UnKTtcdFx0XHRcdFx0XG5cdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAnYWNjb3JkaW9uJzogXG5cdFx0XHRcdGlmIChidXR0b25EYXRhLnNpYmxpbmdzID09ICd5ZXMnKSB7XG5cdFx0XHRcdFx0dG9nZ2xlKHRhcmdldHNSZXZlcnNlLCAnaGlkZScpO1xuXHRcdFx0XHRcdGNsZWFuQnV0dG9ucyh0YXJnZXRCdXR0b25zKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0b2dnbGUodGhpc1RhcmdldCwgJ3Nob3cnKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IFwiZGF0YS1idXR0b24tdHlwZVwiIGF0dHJpYnV0ZSBpcyBzZXQgdG8gdGhlIGJ1dHRvbiBlbGVtZW50IGluIEhUTUwhJyk7XG5cdFx0fVxuXG5cdH1cblxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JBY3Rpb24oYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xuXHRcdGxldCB0YXJnZXRzRm9yQWN0aW9uSWQgPSBidXR0b25EYXRhLnRhcmdldCA/IGJ1dHRvbkRhdGEudGFyZ2V0LnNwbGl0KCcgJykgOiBudWxsLFxuXHRcdCBcdFx0dGFyZ2V0c0ZvckFjdGlvbiA9IFtdO1xuXG5cdFx0aWYgKHRhcmdldHNGb3JBY3Rpb25JZCkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRzRm9yQWN0aW9uSWQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFyZ2V0c0ZvckFjdGlvbi5wdXNoKCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXRzRm9yQWN0aW9uSWRbaV0pICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldHNGb3JBY3Rpb247XG5cdH1cblxuXHRmdW5jdGlvbiB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbihidXR0b25FbGVtZW50LCBidXR0b25EYXRhKSB7XG5cdFx0bGV0XHR0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkID0gYnV0dG9uRGF0YS50YXJnZXRSZXZlcnNlID8gYnV0dG9uRGF0YS50YXJnZXRSZXZlcnNlLnNwbGl0KCcgJykgOiBudWxsLFxuXHRcdFx0XHR0YXJnZXRzRm9yQWN0aW9uR3JvdXAgPSBidXR0b25EYXRhLmdyb3VwID8gYnV0dG9uRGF0YS5ncm91cCA6IG51bGwsXG5cdFx0XHRcdHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uID0gW107XHRcblxuXHRcdGlmICh0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uSWQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24ucHVzaCggZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZFtpXSkgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHRhcmdldHNGb3JBY3Rpb25Hcm91cCkge1xuXHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRhcmdldHNGb3JBY3Rpb25Hcm91cCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uO1xuXHR9XG5cblx0ZnVuY3Rpb24gdGhpc0NvbnRlbnRUYXJnZXQoYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xuXHRcdGxldCB0aGlzVGFyZ2V0ID0gYnV0dG9uRGF0YS5ncm91cCA/IGJ1dHRvbkVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGJ1dHRvbkRhdGEuZ3JvdXApIDogbnVsbDtcblx0XHRyZXR1cm4gdGhpc1RhcmdldDtcblx0fVxuXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uQnV0dG9ucyhidXR0b25FbGVtZW50LCBidXR0b25EYXRhKSB7XG5cdFx0bGV0IHRhcmdldEJ1dHRvbnMgPSBbXTtcblxuXHRcdGlmIChidXR0b25EYXRhLmdyb3VwKSB7XG5cdFx0XHRsZXQgYnV0dG9uc0FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaG93QnV0dG9uW2RhdGEtZ3JvdXA9XCInICsgYnV0dG9uRGF0YS5ncm91cCArICdcIl0nICk7XG5cblx0XHRcdGlmIChidXR0b25zQWxsKSB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYnV0dG9uc0FsbC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGJ1dHRvbnNBbGxbaV0gPT09IGJ1dHRvbkVsZW1lbnQgPyBudWxsIDogdGFyZ2V0QnV0dG9ucy5wdXNoKGJ1dHRvbnNBbGxbaV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldEJ1dHRvbnM7XHRcblx0fVxuXG5cblx0Ly8gLS0tLVNob3cgQ29udGVudCBBY3Rpb25zIC0tLS0tLS0tLVxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy5zaG93QnV0dG9uJywgZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS50aW1lKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cblx0XHRsZXQgdGFyZ2V0Q29udGVudERhdGEgPSB7fTtcblxuXG5cdFx0Ly8gLS0tLS0gdGFyZ2V0Q29udGVudERhdGEgY29uc3RydWN0b3ItLS0tLS1cblx0XHRpZiAodGhpcykge1xuXHRcdFx0bGV0IGJ1dHRvbkRhdGEgPSB0aGlzLmRhdGFzZXQ7XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKGJ1dHRvbkRhdGEpXG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YSA9IHt9O1xuXHRcdFx0dGFyZ2V0Q29udGVudERhdGEuYnV0dG9uRGF0YSA9IGJ1dHRvbkRhdGE7XG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRzID0gdGFyZ2V0c0ZvckFjdGlvbih0aGlzLCBidXR0b25EYXRhICk7XG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRzUmV2ZXJzZSA9IHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uKHRoaXMsIGJ1dHRvbkRhdGEgKTtcblxuXHRcdFx0aWYgKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSA9PT0gXCJhY2NvcmRpb25cIikge1xuXHRcdFx0XHR0YXJnZXRDb250ZW50RGF0YS50aGlzQ29udGVudCA9IHRoaXNDb250ZW50VGFyZ2V0KHRoaXMsIGJ1dHRvbkRhdGEpO1xuXHRcdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRCdXR0b25zID0gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25CdXR0b25zKHRoaXMsIGJ1dHRvbkRhdGEpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyAtLS0tLS0tLUFjdGlvbnMvRXZlbnRzLS0tLS0tLS1cblxuXHRcdFx0aWYgKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSA9PT0gXCJtZW51QnV0dG9uXCIpIHtcblx0XHRcdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKTtcblx0XHRcdFx0dGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdFx0Z2xvYkZ1bmMuc2hvd092ZXJsYXkoXCJtZW51XCIsIGdsb2IucGFnZU92ZXJsYXkpIDogXG5cdFx0XHRcdFx0Z2xvYkZ1bmMuaGlkZU92ZXJsYXkoXCJtZW51XCIsIGdsb2IucGFnZU92ZXJsYXkpO1xuXG5cdFx0XHRcdHRvZ2dsZUNvbnRlbnQodGhpcywgdGFyZ2V0Q29udGVudERhdGEpO1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpO1xuXHRcdFx0XHR0b2dnbGVDb250ZW50KHRoaXMsIHRhcmdldENvbnRlbnREYXRhKTtcdFx0XHRcdFxuXHRcdFx0fVxuXG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUudGltZUVuZCgnY2xpY2sgdG9nZ2xlIHdvcmtpbmcgdGltZScpO1xuXHRcdFx0XG5cdH0pO1xuXG5cbn0pKCk7Ki9cbiAgLypnbG9iLlN3aXRjaFRhYnNNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXG5cdGNvbnN0IGRlZmF1bHRUYWJzQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWJzTmF2IC50YWJCdXR0b24nKSxcblx0ZGVmYXVsdFRhYnNCbG9ja3NDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9nZ2xlQmxvY2tzLWxpc3QnKSxcblx0ZGVmYXVsdFRhYnNCbG9ja3NMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvZ2dsZUJsb2NrJyk7XG5cblxuXHRmdW5jdGlvbiBzd2l0Y2hUYWJzKHRhYkJ1dHRvbiwgdGFic0Jsb2NrcywgdGFiQnV0dG9ucykge1xuXHRcdGxldCB0YXJnZXQgPSB0YWJCdXR0b24uZGF0YXNldC50YXJnZXQ7XG5cblx0XHRpZiAoICF0YWJCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFic0Jsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR0YWJCdXR0b25zW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuXHRcdFx0XHR0YWJzQmxvY2tzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuXG5cdFx0XHRcdGlmICh0YXJnZXQgPT09IHRhYnNCbG9ja3NbaV0uaWQpIHtcblx0XHRcdFx0XHR0YWJCdXR0b24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxuXHRcdFx0XHRcdHRhYnNCbG9ja3NbaV0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxuXHRcdFx0XHR9IFxuXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cbiAgLy8gLS0tZXZlbnRzLS0tXG5cbiAgJCgnLnRhYnNOYXYnKS5vbignY2xpY2snLCAnLnRhYkJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuICBcdFx0dmFyIHRhYnNHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy5kYXRhc2V0LnRhYnNHcm91cClcbiAgXHRcdHZhciB0YWJCdXR0b25zID0gdGhpcy5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RhYkJ1dHRvbicpXG4gIFx0XHR2YXIgdGFic0Jsb2Nrc0NvbnRhaW5lciA9IHRoaXMucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy5kYXRhc2V0LnRhYnNDb250YWluZXIpWzBdXG5cbiAgXHRcdC8vIGNvbnNvbGUubG9nKHRhYkJ1dHRvbnMpXG4gIFx0XHQvLyBjb25zb2xlLmxvZyh0YWJzQmxvY2tzQ29udGFpbmVyKVxuICBcdFx0aWYgKHRhYnNHcm91cC5sZW5ndGgpIHtcdHN3aXRjaFRhYnModGhpcywgdGFic0dyb3VwLCB0YWJCdXR0b25zKTt9XG4gIFx0XHRlbHNlIHsgc3dpdGNoVGFicyh0aGlzLCBkZWZhdWx0VGFic0Jsb2Nrc0xpc3QsIHRhYkJ1dHRvbnMpO1x0fVxuXG4gIFx0XHRpZiAodGFic0Jsb2Nrc0NvbnRhaW5lcikge2dsb2JGdW5jLmFuaW1hdGVCbG9jayh0YWJzQmxvY2tzQ29udGFpbmVyKTt9XG4gIFx0XHRlbHNlIHtnbG9iRnVuYy5hbmltYXRlQmxvY2soZGVmYXVsdFRhYnNCbG9ja3NDb250YWluZXIpO31cdCAgXHRcdFxuICB9KVxuXG5cbn0pKCk7Ki9cbiAgLypnbG9iLlRleHRMaW1pdE1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdGNvbnNvbGUubG9nKCdUZXh0TGltaXRNb2R1bGUgb2snKTtcblxuXHRmdW5jdGlvbiBzbGljZVRleHQoc2xpY2luZ0Jsb2NrcywgbWF4TGVuZ3RoKSB7XG5cdFx0aWYgKHNsaWNpbmdCbG9ja3MpIHtcblxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzbGljaW5nQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGxldCBjdXJyZW50VGV4dCA9IHNsaWNpbmdCbG9ja3NbaV0uaW5uZXJIVE1MO1xuXG5cdFx0XHRcdGlmIChjdXJyZW50VGV4dC5sZW5ndGggPiBtYXhMZW5ndGgpIHtcblx0XHRcdFx0XHRzbGljaW5nQmxvY2tzW2ldLmlubmVySFRNTCA9IGN1cnJlbnRUZXh0LnNsaWNlKDAsIG1heExlbmd0aCkgKyAnIC4uLic7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblx0fVxuXHRcblx0cmV0dXJuIHtcblx0XHRzbGljZVRleHQ6IHNsaWNlVGV4dCxcblx0fVxuXG59KSgpOyovXG4gIC8qZ2xvYi5TdGlja3lCbG9ja01vZHVsZSA9IChmdW5jdGlvbigpIHtcblxuICB2YXIgdGFyZ2V0O1xuICB2YXIgcmVsYXRpdmU7XG4gIHZhciBpc0FjdGl2ZSA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIHRvU3RpY2sodGFyZ2V0QmxvY2ssIHJlbGF0aXZlQmxvY2spIHtcbiAgICB0YXJnZXQgPSB0YXJnZXRCbG9jaztcbiAgICByZWxhdGl2ZSA9IHJlbGF0aXZlQmxvY2s7XG4gICAgaXNBY3RpdmUgPSB0cnVlO1xuICAgIC8vIGNsKCdhY3RpdmF0ZSAnLCBpc0FjdGl2ZSlcblxuICAgIHRvU2Nyb2xsKGlzQWN0aXZlKVxuICB9XG5cbiAgZnVuY3Rpb24gdW5TdGljaygpIHtcbiAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuICAgIC8vIGNsKCdkZWFjdGl2YXRlJylcbiAgICB0b1Njcm9sbChpc0FjdGl2ZSkgICAgXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGNoZWNrUG9zaXRpb24odGFyZ2V0QmxvY2ssIHJlbGF0aXZlQmxvY2spIHtcbiAgICBpZiAoICFnbG9iRnVuYy5pc1Zpc2libGUocmVsYXRpdmVCbG9jaywgJ3RvcEJvcmRlcicpICkge1xuXG4gICAgICBpZiAoICF0YXJnZXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX2ZpeGVkX25hdicpICkge1xuICAgICAgICB0YXJnZXRCbG9jay5zdHlsZS53aWR0aCA9IHRhcmdldEJsb2NrLm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgdGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZCgnanNfZml4ZWRfbmF2Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChnbG9iRnVuYy5nZXRDb29yZHNPblNjcmVlbih0YXJnZXRCbG9jaykuYm90dG9tID49IGdsb2JGdW5jLmdldENvb3Jkc09uU2NyZWVuKHJlbGF0aXZlQmxvY2spLmJvdHRvbSkge1xuICAgICAgICB0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19hYnNvbHV0ZV9uYXYnKTtcbiAgICAgICAgdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfZml4ZWRfbmF2Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICggdGFyZ2V0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19hYnNvbHV0ZV9uYXYnKSApIHtcbiAgICAgICAgaWYgKGdsb2JGdW5jLmlzVmlzaWJsZSh0YXJnZXRCbG9jaywgXCJ0b3BCb3JkZXJcIikpIHtcbiAgICAgICAgICB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19hYnNvbHV0ZV9uYXYnKTtcbiAgICAgICAgICB0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19maXhlZF9uYXYnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICggdGFyZ2V0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19maXhlZF9uYXYnKSApIHtcbiAgICAgICAgdGFyZ2V0QmxvY2suc3R5bGUud2lkdGggPSAnJztcbiAgICAgICAgdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfZml4ZWRfbmF2Jyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gdG9TY3JvbGwoc3RhdHVzKSB7XG4gICAgaWYgKHN0YXR1cykge1xuICAgICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0YXJnZXQgJiYgcmVsYXRpdmUpIHtcbiAgICAgICAgICBjaGVja1Bvc2l0aW9uKHRhcmdldCwgcmVsYXRpdmUpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG4gIFxuICBcblxuICByZXR1cm4ge1xuICAgIHRvU3RpY2s6IHRvU3RpY2ssXG4gICAgdW5TdGljazogdW5TdGljayxcbiAgfVxuXG59KSgpKi9cbiAgLypnbG9iLkxhenlMb2FkTW9kdWxlICA9IChmdW5jdGlvbigpIHtcblx0dmFyIGxhenlCbG9ja3MgPSBbXVxuXG5cdGZ1bmN0aW9uIGluaXQoc2VsZWN0b3IpIHtcblx0XHRzZXRMYXp5KHNlbGVjdG9yKTtcblx0XHRsYXp5TG9hZChsYXp5QmxvY2tzKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHNldExhenkoY2xhc3NTZWxlY3Rvcil7XG5cdFx0Ly8gY29uc29sZS5sb2coc2VsZWN0b3IpXG5cdFx0bGF6eUJsb2NrcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoY2xhc3NTZWxlY3Rvcik7XG5cdFx0XHQvLyBjbChsYXp5QmxvY2tzLmxlbmd0aClcblx0XHRpZiAobGF6eUJsb2Nrcy5sZW5ndGgpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGF6eUJsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAoIWxhenlCbG9ja3NbaV0uZ2V0QXR0cmlidXRlKCdoYXMtcHJlbG9hZGVyJykpIHtcblx0XHRcdFx0XHR2YXIgcHJlbG9hZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdFx0cHJlbG9hZGVyLmNsYXNzTmFtZSA9ICdpbWdQcmVsb2FkZXInO1xuXHRcdFx0XHRcdHByZWxvYWRlci5pbm5lckhUTUwgPSAnPGltZyBzcmM9XCIvaW1nL2ljb25zL2xhenlfcHJlbG9hZGVyLmpwZ1wiIGFsdD1cImxvYWRlclwiPidcblx0XHRcdFx0XHRsYXp5QmxvY2tzW2ldLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQocHJlbG9hZGVyKTtcblx0XHRcdFx0XHRsYXp5QmxvY2tzW2ldLnNldEF0dHJpYnV0ZSgnaGFzLXByZWxvYWRlcicsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuICAgIC8vIGNvbnNvbGUubG9nKCdGb3VuZCAnICsgbGF6eUJsb2Nrcy5sZW5ndGggKyAnIGxhenkgaW1hZ2VzJyk7XG5cdH1cblxuXHRmdW5jdGlvbiBsb2FkZWQoZWwpIHtcbiAgICAvLyBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3JjJyk7XG4gICAgLy8gZWwuY2xhc3NMaXN0LnJlbW92ZSgnbGF6eUJsb2NrJyk7XG5cdFx0bGV0IGxvYWRlciA9IGVsLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaW1nUHJlbG9hZGVyJylbMF07XG5cdFx0aWYgKGxvYWRlcikgJChsb2FkZXIpLmZhZGVPdXQoKTtcblx0XHQvLyBjbGVhbkxhenkoKVxuXHR9XG5cblx0ZnVuY3Rpb24gbG9hZEltYWdlKGVsZW1lbnQpIHtcblx0XHRpZiggaXNJblZpZXdwb3J0KGVsZW1lbnQpICkge1xuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lzTG9hZGluZycsIHRydWUpO1xuXG5cdFx0XHRpZiAoZWxlbWVudC50YWdOYW1lICE9PSAnSU1HJykge1xuXHRcdFx0XHR2YXIgaW1nID0gbmV3IEltYWdlKCk7XG5cdFx0XHRcdHZhciBzcmNEYXRhID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJyk7XG5cdFx0XHRcdGlmIChzcmNEYXRhKSB7IFxuXHRcdFx0XHRcdGltZy5vbmxvYWQgPSBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdCAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKCcgKyBpbWcuZ2V0QXR0cmlidXRlKCdzcmMnKSArICcpJztcblx0XHRcdFx0XHQgIGxvYWRlZChlbGVtZW50KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0Ly8gZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3JjJyk7XG5cdFx0XHRcdFx0aW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgc3JjRGF0YSk7IFxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR2YXIgc3JjRGF0YSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpO1xuXHRcdFx0XHRpZiAoc3JjRGF0YSl7XG5cdFx0XHRcdFx0ZWxlbWVudC5vbmxvYWQgPSBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdCAgbG9hZGVkKGVsZW1lbnQpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZSgnc3JjJywgc3JjRGF0YSk7IFxuXHRcdFx0XHRcdC8vIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNyYycpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gbGF6eUxvYWQobGF6eUJsb2Nrcykge1xuXHRcdC8vIGlmIChsYXp5QmxvY2tzLmxlbmd0aCkge1xuXHRcdFx0bGV0IGxhenlCID0gbGF6eUJsb2Nrcztcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGF6eUIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIGlzTG9hZGluZyA9IGxhenlCW2ldLmdldEF0dHJpYnV0ZSgnaXNMb2FkaW5nJyk7XG5cdFx0XHRcdGlmICggaXNMb2FkaW5nICE9ICd0cnVlJyApIHtcblx0XHRcdFx0XHRsb2FkSW1hZ2UobGF6eUJbaV0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNsZWFuTGF6eSgpXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdC8vIGNsZWFuTGF6eSgpXG5cdFx0Ly8gfVxuXHR9XG5cblx0ZnVuY3Rpb24gY2xlYW5MYXp5KCl7XG5cdFx0aWYgKGxhenlCbG9ja3MubGVuZ3RoKSB7XG5cdFx0XHRsYXp5QmxvY2tzID0gIEFycmF5LnByb3RvdHlwZS5maWx0ZXIuY2FsbChsYXp5QmxvY2tzLCBmdW5jdGlvbihsKXsgcmV0dXJuIGwuZ2V0QXR0cmlidXRlKCdpc0xvYWRpbmcnKSAhPSAndHJ1ZSc7fSk7XG5cdFx0fVxuXHQgICAgLy8gY2wobGF6eUJsb2Nrcy5sZW5ndGgpXG5cdH1cblxuXG5cdGZ1bmN0aW9uIGlzSW5WaWV3cG9ydChlbCl7XG4gICAgdmFyIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBcbiAgICByZXR1cm4gKFxuICAgICAgICByZWN0LmJvdHRvbSA+PSAwICYmIFxuICAgICAgICAvLyByZWN0LnJpZ2h0ID49IDAgJiYgXG4gICAgICAgIHJlY3QudG9wIDw9ICh3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodClcbiAgICAgICAgLy8gcmVjdC5sZWZ0IDw9ICh3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpXG4gICAgKTtcblx0fVxuXG5cdHZhciB0aW1lciA9IG51bGw7XG5cdCQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24gKCkge1xuXHRcdGlmICh0aW1lcikgeyBjbGVhclRpbWVvdXQodGltZXIpOyB9XG5cblx0ICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgXHR0aW1lciA9IG51bGw7XG5cdCAgICBcblx0ICAgIC8vIHNldExhenkoKTtcblx0ICAgIC8vIGNsKGxhenlCbG9ja3MubGVuZ3RoKVxuXHQgICAgaWYgKGxhenlCbG9ja3MubGVuZ3RoKSB7IGxhenlMb2FkKGxhenlCbG9ja3MpOyB9XG5cblx0ICB9LCA1MCk7XG5cdH0pXG5cblx0Ly8gLS0tLS0tLS0tLS0tXG5cblx0cmV0dXJuIHtcblx0ICBpbml0TGF6eTogaW5pdCxcblx0ICAvLyBsYXp5TG9hZDogbGF6eUxvYWQsXG5cdH1cblxuXG59KSgpOyovXG4gIC8qZ2xvYi5PcGVuQ2xvc2VNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHQvLyBjb25zb2xlLmxvZygnT3BlbkNsb3NlTW9kdWxlIG9rJyk7XG5cdC8vIGNvbnNvbGUudGltZSgnVG9nZ2xlQ29udGVudCBNb2R1bGUgbG9hZCcpO1xuXG5cdGZ1bmN0aW9uIGluaXRpYXRlKGJ1dHRvbkVsZW1lbnQpIHtcblx0XHRsZXQgYnV0dG9uID0gYnV0dG9uRWxlbWVudCxcblx0XHRcdFx0YnV0dG9uRGF0YSA9IGJ1dHRvbi5kYXRhc2V0LFxuXHRcdFx0XHR0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChidXR0b25EYXRhLnRhcmdldCksXG5cdFx0XHRcdGNvbnRyb2xDbGFzcyA9IGJ1dHRvbkRhdGEuY2xhc3M7XG5cblx0XHQvLyAtLS0tLS1NZXRob2RzLS0tLS0tLS1cblx0XHRpZiAodGFyZ2V0ICYmIGNvbnRyb2xDbGFzcykge1xuXG5cdFx0XHRpZiAoYnV0dG9uRGF0YS5hY3Rpb24pIHtcblx0XHRcdFx0aWYgKGJ1dHRvbkRhdGEuYWN0aW9uID09ICdvcGVuJykge1xuXHRcdFx0XHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQoYnV0dG9uKTtcblx0XHRcdFx0XHR0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbnRyb2xDbGFzcykgPyBudWxsIDogdGFyZ2V0LmNsYXNzTGlzdC5hZGQoY29udHJvbENsYXNzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChidXR0b25EYXRhLmFjdGlvbiA9PSAnY2xvc2UnKSB7XG5cdFx0XHRcdFx0dmFyIHRoaXNHcm91cE9wZW5CdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm9wZW5CdXR0b25bZGF0YS10YXJnZXQ9XCInICsgYnV0dG9uRGF0YS50YXJnZXQgKyAnXCJdJyApO1xuXHRcdFx0XHRcdGlmICh0aGlzR3JvdXBPcGVuQnV0dG9ucy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpc0dyb3VwT3BlbkJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0dGhpc0dyb3VwT3BlbkJ1dHRvbnNbaV0uZGF0YXNldC5hY3Rpb24gPT0gJ29wZW4nID8gZ2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzR3JvdXBPcGVuQnV0dG9uc1tpXSkgOiBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbnRyb2xDbGFzcykgPyB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShjb250cm9sQ2xhc3MpIDogbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0fVx0ZWxzZSB7IFxuXHRcdFx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KGJ1dHRvbik7XG5cdFx0XHRcdHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKGNvbnRyb2xDbGFzcyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9XHRcdFx0XG5cdH1cblxuXHQvLyAtLS0tU2hvdyBDb250ZW50IEFjdGlvbnMgLS0tLS0tLS0tXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLm9wZW5CdXR0b24nLCBmdW5jdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLnRpbWUoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblxuXHRcdC8vIC0tLS0tLS0tQWN0aW9ucy9FdmVudHMtLS0tLS0tLVxuXG5cdFx0Ly8gZ2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKTtcblx0XHRpbml0aWF0ZSh0aGlzKTtcdFx0XHRcdFxuXHRcdC8vIGNvbnNvbGUudGltZUVuZCgnY2xpY2sgdG9nZ2xlIHdvcmtpbmcgdGltZScpO1xuXHRcdFx0XG5cdH0pO1xuXG5cbn0pKCk7Ki9cbiAgLypnbG9iLlJhZGlvT3BlbkNsb3NlTW9kdWxlICA9IChmdW5jdGlvbigpIHtcblx0Ly8gY29uc29sZS5sb2coJ09wZW5DbG9zZU1vZHVsZSBvaycpO1xuXHQvLyBjb25zb2xlLnRpbWUoJ1RvZ2dsZUNvbnRlbnQgTW9kdWxlIGxvYWQnKTtcblxuXHRmdW5jdGlvbiBoaWRlR3JvdXAoZ3JvdXBOYW1lLCBjb250cm9sQ2xhc3MpIHtcblx0XHR2YXIgZ3JvdXBCbG9ja3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGdyb3VwTmFtZSk7XG5cblx0XHRpZiAoZ3JvdXBCbG9ja3MubGVuZ3RoKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGdyb3VwQmxvY2tzW2ldLmNsYXNzTGlzdC5jb250YWlucyhjb250cm9sQ2xhc3MpID8gZ3JvdXBCbG9ja3NbaV0uY2xhc3NMaXN0LnJlbW92ZShjb250cm9sQ2xhc3MpIDogbnVsbDtcblx0XHRcdH1cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGluaXRpYXRlKGJ1dHRvbnMpIHtcblx0XHR2YXIgYnV0dG9uLFxuXHRcdFx0XHRidXR0b25EYXRhLFxuXHRcdFx0XHR0YXJnZXQsXG5cdFx0XHRcdGNvbnRyb2xDbGFzcyxcblx0XHRcdFx0aXNHcm91cENoYW5nZSwgY3VycmVudEdyb3VwO1xuXHRcdFxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYnV0dG9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0YnV0dG9uID0gYnV0dG9uc1tpXSxcblx0XHRcdGJ1dHRvbkRhdGEgPSBidXR0b24uZGF0YXNldCxcblx0XHRcdHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJ1dHRvbkRhdGEudGFyZ2V0KSxcblx0XHRcdGNvbnRyb2xDbGFzcyA9IGJ1dHRvbkRhdGEuY2xhc3M7XG5cdFx0XHRpc0dyb3VwQ2hhbmdlID0gY3VycmVudEdyb3VwID09PSBidXR0b24ubmFtZSA/IGZhbHNlIDogdHJ1ZTtcblx0XHRcdGN1cnJlbnRHcm91cCA9IGJ1dHRvbi5uYW1lO1xuXG5cdFx0XHRpZiAoaXNHcm91cENoYW5nZSkge1xuXHRcdFx0XHRoaWRlR3JvdXAoY3VycmVudEdyb3VwLCBjb250cm9sQ2xhc3MpXG5cdFx0XHR9XG5cblx0XHRcdGlmIChidXR0b24uY2hlY2tlZCAmJiB0YXJnZXQpIHtcblx0XHRcdFx0dGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhjb250cm9sQ2xhc3MpID8gbnVsbCA6IHRhcmdldC5jbGFzc0xpc3QuYWRkKGNvbnRyb2xDbGFzcyk7XG5cdFx0XHR9XHRcdFx0XG5cdFx0fVxuXHRcblx0fVxuXG5cdHZhciBhbGxSYWRpb0J1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdyYWRpb0J1dHRvbicpO1xuXG5cdGlmIChhbGxSYWRpb0J1dHRvbnMubGVuZ3RoKSB7IGluaXRpYXRlKGFsbFJhZGlvQnV0dG9ucyl9XG5cdC8vIC0tLS1TaG93IENvbnRlbnQgQWN0aW9ucyAtLS0tLS0tLS1cblx0JCgnYm9keScpLm9uKCdjbGljaycsICcucmFkaW9CdXR0b24nLCBmdW5jdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLnRpbWUoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblxuXHRcdC8vIC0tLS0tLS0tQWN0aW9ucy9FdmVudHMtLS0tLS0tLVxuXHRcdHZhciBidXR0b24gPSBbXTtcblx0XHRidXR0b24ucHVzaCh0aGlzKVxuXHRcdC8vIGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcyk7XG5cdFx0aW5pdGlhdGUoYnV0dG9uKTtcdFx0XHRcdFxuXHRcdC8vIGNvbnNvbGUudGltZUVuZCgnY2xpY2sgdG9nZ2xlIHdvcmtpbmcgdGltZScpO1xuXHRcdFx0XG5cdH0pO1xuXG5cbn0pKCk7Ki9cbiBcblx0Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXHRnbG9iLm5hdk1lbnVXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdk1lbnVXcmFwcGVyJyk7XG5cdGdsb2IubmF2TWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZNZW51Jyk7XG5cdGdsb2IucGFnZU92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZU92ZXJsYXknKTtcblxuXHRpZiAoISQoJ2JvZHknKSkge2NvbnNvbGUubG9nKCdqUXVlcnkgRXJyb3InKX1cblx0Ly8gY29uc29sZS5sb2codGVzdCk7XG5cblx0LyokKCcubWFpbkhlYWRlcicpLm9uKCdjbGljaycsICcubWVudS1idXR0b24nLCBmdW5jdGlvbihlKSB7XG5cdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKVx0XG5cdH0pXG5cblx0JCgnLm1haW5IZWFkZXInKS5vbignYmx1cicsICcubWVudS1idXR0b24nLCBmdW5jdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLmxvZygnYmx1cicpXG5cdFx0aWYgKHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xuXHRcdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKVx0XHRcdFxuXHRcdH1cblx0fSkqL1xuXG5cdCQoJy5kcm9wZG93bkJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcylcblx0XHRnbG9iRnVuYy5kcm9wRG93bih0aGlzLCBnbG9iLm5hdk1lbnVXcmFwcGVyKVxuXHR9KVxuXG5cbiAgLy8gLS0tLS0tLS0tUG9wdXBzIEJsb2NrLS0tLS0tLVxuXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLnNlYXJjaEJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuICBcdC8vIGUucHJldmVudERlZmF1bHQoKTtcbiAgXHRsZXQgbW9kYWwgPSAkKCcjcG9wdXBTZWFyY2gnKTtcbiAgXHRpZiAoIG1vZGFsLmxlbmd0aCApIHtcbiAgXHRcdGdsb2IuUG9wdXBNb2R1bGUub3BlblBvcHVwKG1vZGFsLCBcImpzX29wZW5Qb3B1cF9zZWFyY2hcIik7XG4gIFx0fVxuICB9KTtcblxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJy5idXR0b24nLCBmdW5jdGlvbigpIHtcbiAgXHQvLyBlLnByZXZlbnREZWZhdWx0KCk7XG4gIFx0bGV0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lkJyk7XG4gIFx0aWYgKCBtb2RhbCApIHtcbiAgXHRcdGdsb2IuUG9wdXBNb2R1bGUub3BlblBvcHVwKG1vZGFsKTtcbiAgXHR9XG4gIH0pO1xuXG4gIC8vIC0tLS0tLS0tLUFjY29yZGlvbiBCbG9ja3MtLS0tLS0tXG5cdC8qJCgnYWNjb3JkaW9uQmxvY2tTZWxlY3RvcicpLm9uKCdjbGljaycsICcuYnV0dG9uU2VsZWN0b3InLCBmdW5jdGlvbihlKSB7XG5cdFx0Ly8gY29uc29sZS50aW1lKCdjbGljayBhY2NvcmRpb24gd29ya2luZyB0aW1lJyk7XG5cblx0XHRpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIDwgOTkyKSB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0bGV0IHN1Ym1lbnVCbG9jaztcblx0XHRcdGxldCBidXR0b24gPSB0aGlzO1xuXG5cdFx0XHR0aGlzLmNsYXNzTGlzdC5jb250YWlucygnc2lkZWJhck9wZW5CdXR0b24nKSA/IFxuXHRcdFx0XHRzdWJtZW51QmxvY2sgPSB0aGlzLnBhcmVudEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nIDogXG5cdFx0XHRcdHN1Ym1lbnVCbG9jayA9IHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG5cdFx0Ly8gbGV0IHNpYmxpbmdzQmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3B1YmxpY0luZm9QYWdlIGFydGljbGUucHVibGljSW5mby1ibG9jayAudGl0bGVCbG9jayArIC5oaWRkZW5Db250ZW50Jyk7XG5cblx0XHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQoYnV0dG9uKTtcblx0XHRcdGdsb2IuQWNjb3JkaW9uTW9kdWxlLnRvZ2dsZUNvbnRlbnQoXCJ3aXRob3V0U2libGluZ3NcIiwgYnV0dG9uLCBzdWJtZW51QmxvY2sgKTtcblx0XHRcdC8vIEFjY29yZGlvbk1vZHVsZS50b2dnbGVDb250ZW50KFwid2l0aFNpYmxpbmdzXCIsIGJ1dHRvbiwgc3VibWVudUJsb2NrLCBzaWJsaW5nc0Jsb2NrcyApO1x0XHRcdFx0XG5cblx0XHR9XG5cdFx0Ly8gY29uc29sZS50aW1lRW5kKCdjbGljayBhY2NvcmRpb24gd29ya2luZyB0aW1lJyk7XG5cdH0pKi9cblxuICAvLyAtLS0tLS0tLS1UZXh0IExpbWl0LS0tLS0tLVxuXHQvKmxldCB0ZXh0QmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlbGVjdG9yJyk7XG5cdHRleHRCbG9ja3MubGVuZ3RoID8gVGV4dExpbWl0TW9kdWxlLnNsaWNlVGV4dCh0ZXh0QmxvY2tzLCAxODApIDogbnVsbDsqL1xuXHQkKFwiLmRlc2NyaXB0aW9uIC5lbGxpcHNpc1wiKS5kb3Rkb3Rkb3Qoe1x0aGVpZ2h0OiA4MCxcdHRydW5jYXRlOiBcIndvcmRcIixcdHdhdGNoOiB0cnVlfSk7XG5cdCQoXCIudGl0bGUuZWxsaXBzaXNcIikuZG90ZG90ZG90KHtcdGhlaWdodDogODUsXHR0cnVuY2F0ZTogXCJ3b3JkXCIsXHR3YXRjaDogdHJ1ZX0pO1xuXHRcblxuXHQvLyAtLS0tLS0tLS0tU2Nyb2xsLXRvIFNlY3Rpb24tLS0tLS0tLS0tLS0tLS1cblx0XG5cdC8qJCgnYm9keScpLm9uKCdjbGljaycsICdhcnRpY2xlLnN0b3J5LWl0ZW0nLCBmdW5jdGlvbigpIHtcblx0XHRcblx0XHQkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7XG5cdFx0XHRzY3JvbGxUb3A6ICQoXCIjXCIgKyAkKHRoaXMpLmF0dHIoJ2RhdGEtc3RvcnktaWQnKSApLm9mZnNldCgpLnRvcFxuXHRcdH0sIDUwMCk7XG5cdH0pKi9cblxuXHQvLyAtLS0tLS0tLS0tIFN0aWNreSBibG9jay0tLS0tLS0tLS0tLS0tLVxuXHQvKnZhciBzdGlja3lBc2lkZUJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYXNpZGUuc3RpY2t5Jyk7XG5cblx0aWYgKCBzdGlja3lBc2lkZUJsb2NrICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA+IDk5MSApIHtcblx0XHR2YXIgdGFyZ2V0U3RpY2tCbG9jayA9IHN0aWNreUFzaWRlQmxvY2suZmlyc3RFbGVtZW50Q2hpbGQ7XG5cdFx0bGV0IHJlbGF0aXZlQmxvY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdGlja3lBc2lkZUJsb2NrLmRhdGFzZXQuc3RpY2tUbylcblxuXHRcdGdsb2IuU3RpY2t5QmxvY2tNb2R1bGUudG9TdGljayh0YXJnZXRTdGlja0Jsb2NrLCByZWxhdGl2ZUJsb2NrKTtcdFx0XG5cdH0qL1xuXG5cdC8vIC0tLS0tLS0tLUNsZWFuIGVtcHR5IFRhZ3MtLS0tLVxuXHR2YXIgdGV4dEJsb2NrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZXNjcmlwdGlvbiA+IHAnKTtcblxuXHRpZiAodGV4dEJsb2Nrcy5sZW5ndGgpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRleHRCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRleHRCbG9ja3NbaV0uaW5uZXJIVE1MID8gbnVsbCA6IHRleHRCbG9ja3NbaV0ucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0ZXh0QmxvY2tzW2ldKTtcblx0XHR9XG5cdH1cblxuXHQvLyAtLS0tLS0tU2VsZWN0LS0tLS0tLS0tLVxuXHQvKiQoXCIuY2hvc2VuLXdyYXBwZXIgc2VsZWN0XCIpLmNob3Nlbih7XG5cdCAgZGlzYWJsZV9zZWFyY2hfdGhyZXNob2xkOiA4LFxuXHQgIG5vX3Jlc3VsdHNfdGV4dDogXCLQndC40YfQtdCz0L4g0L3QtSDQvdCw0LnQtNC10L3QviFcIixcblx0ICB3aWR0aDogXCIxMDAlXCJcblx0fSk7Ki9cblxuXG5cblx0Ly8gPT09PT09PT09PT1Jbml0aWFsaXphdGlvbnM9PT09PT09PT09PT09XG5cblx0Ly8gQW5pbWF0ZUJvcmRlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYW5pbWF0ZWQtYm9yZGVyLWJsb2NrIHN2ZycpLCB7XG5cdC8vIFx0Ym9yZGVyV2lkdGg6IDMsXG5cdC8vIFx0c2hhZGVkU2VjdGlvbjogMTAwLFxuXHQvLyBcdHRyYW5zcGFyZW50U2VjdGlvbjogMjUsXG5cdC8vIFx0cmV2ZXJzZTogZmFsc2UsXG5cdC8vIFx0cmFkaXVzOiB0cnVlIFxuXHQvLyB9KVxuXG59KTtcblxuXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XG5cdGNvbnNvbGUubG9nKCd3aW5kb3cgbG9hZCcpXG5cdC8vICQoJyNwYWdlLXByZWxvYWRlcicpLmZhZGVPdXQoJ3Nsb3cnKTtcblxuXHQvLyBnbG9iLkxhenlMb2FkTW9kdWxlLmluaXRMYXp5KCdsYXp5QmxvY2snKVxufVxuXG5cbiJdfQ==
